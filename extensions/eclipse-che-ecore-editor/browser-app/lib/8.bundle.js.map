{"version":3,"sources":["webpack:///../node_modules/@theia/output/src/browser/output-contribution.ts","webpack:///../node_modules/@theia/output/src/browser/output-widget.tsx","webpack:///../node_modules/@theia/output/src/common/output-channel.ts","webpack:///../node_modules/@theia/output/src/common/output-preferences.ts","webpack:///../node_modules/@theia/output/src/browser/style/output.css?577e","webpack:///../node_modules/@theia/output/src/browser/style/output.css","webpack:///../node_modules/vscode-ws-jsonrpc/src/connection.ts","webpack:///../node_modules/vscode-ws-jsonrpc/src/disposable.ts","webpack:///../node_modules/vscode-ws-jsonrpc/src/index.ts","webpack:///../node_modules/vscode-ws-jsonrpc/src/logger.ts","webpack:///../node_modules/vscode-ws-jsonrpc/src/socket/connection.ts","webpack:///../node_modules/vscode-ws-jsonrpc/src/socket/index.ts","webpack:///../node_modules/vscode-ws-jsonrpc/src/socket/reader.ts","webpack:///../node_modules/vscode-ws-jsonrpc/src/socket/writer.ts","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/cancellation.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/events.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/is.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/linkedMap.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/main.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/messageReader.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/messageWriter.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/messages.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/pipeSupport.js","webpack:///../node_modules/vscode-ws-jsonrpc/node_modules/vscode-jsonrpc/lib/socketSupport.js"],"names":["Object","defineProperty","exports","value","events_1","require","Is","CancellationToken","None","freeze","isCancellationRequested","onCancellationRequested","Event","Cancelled","is","candidate","shortcutEvent","callback","context","handle","setTimeout","bind","dispose","clearTimeout","MutableToken","_isCancelled","prototype","cancel","_emitter","fire","undefined","get","enumerable","configurable","Emitter","event","CancellationTokenSource","_token","Disposable","create","func","_disposable","CallbackList","add","bucket","_this","_callbacks","_contexts","push","Array","isArray","remove","foundCallbackWithDifferentContext","i","len","length","splice","Error","invoke","args","_i","arguments","ret","callbacks","slice","contexts","apply","e","console","error","isEmpty","_options","_event","listener","thisArgs","disposables","onFirstListenerAdd","result","_noop","onLastListenerRemove","call","toString","boolean","string","number","array","stringArray","every","elem","Touch","First","Last","LinkedMap","_map","Map","_head","_tail","_size","clear","has","key","item","set","touch","next","previous","addItemLast","addItemFirst","removeItem","shift","forEach","callbackfn","thisArg","current","forEachReverse","values","keys","__extends","extendStatics","setPrototypeOf","__proto__","d","b","p","hasOwnProperty","__","constructor","__export","m","messages_1","RequestType","RequestType0","RequestType1","RequestType2","RequestType3","RequestType4","RequestType5","RequestType6","RequestType7","RequestType8","RequestType9","ResponseError","ErrorCodes","NotificationType","NotificationType0","NotificationType1","NotificationType2","NotificationType3","NotificationType4","NotificationType5","NotificationType6","NotificationType7","NotificationType8","NotificationType9","messageReader_1","MessageReader","StreamMessageReader","IPCMessageReader","SocketMessageReader","messageWriter_1","MessageWriter","StreamMessageWriter","IPCMessageWriter","SocketMessageWriter","cancellation_1","linkedMap_1","CancelNotification","type","NullLogger","warn","info","log","Trace","fromString","toLowerCase","Off","Messages","Verbose","SetTraceNotification","LogTraceNotification","ConnectionErrors","ConnectionError","_super","code","message","ConnectionStrategy","cancelUndispatched","ConnectionState","_createMessageConnection","messageReader","messageWriter","logger","strategy","sequenceNumber","notificationSquenceNumber","unknownResponseSquenceNumber","version","starRequestHandler","requestHandlers","starNotificationHandler","notificationHandlers","timer","messageQueue","responsePromises","requestTokens","trace","tracer","state","New","errorEmitter","closeEmitter","unhandledNotificationEmitter","disposeEmitter","createRequestQueueKey","id","createResponseQueueKey","createNotificationQueueKey","addMessageToQueue","queue","isRequestMessage","isResponseMessage","_message","isListening","Listening","isClosed","Closed","isDisposed","Disposed","closeHandler","readErrorHandler","writeErrorHandler","data","onClose","onError","triggerMessageQueue","size","setImmediate","processMessageQueue","handleRequest","isNotificationMessage","handleNotification","handleResponse","handleInvalidMessage","method","params","toCancel","response","traceSendingResponse","Date","now","write","requestMessage","reply","resultOrError","startTime","jsonrpc","toJson","replyError","replySuccess","traceReceivedRequest","element","requestHandler","handler","cancellationSource","tokenKey_1","String","handlerResult","numberOfParams","token","concat","promise","then","InternalError","MethodNotFound","responseMessage","JSON","stringify","responsePromise","traceReceivedResponse","reject","resolve","notificationHandler","source","traceReceivedNotification","responseHandler","traceSendingRequest","traceSendNotification","timerStart","throwIfClosedOrDisposed","throwIfListening","AlreadyListening","throwIfNotListening","undefinedToNull","param","computeMessageParams","connection","sendNotification","messageParams","notificationMessage","onNotification","sendRequest","last","map","Promise","MessageWriteError","onRequest","_value","_tracer","onUnhandledNotification","onDispose","listen","inspect","verbose","isMessageReader","read","isMessageWriter","end","createMessageConnection","input","output","reader","writer","DefaultSize","CR","Buffer","LF","CRLF","MessageBuffer","encoding","index","buffer","append","chunk","toAppend","str","bufferLen","byteLength","copy","newSize","Math","ceil","tryReadHeaders","headers","split","header","indexOf","substr","trim","nextStart","tryReadContent","onPartialMessage","AbstractMessageReader","partialMessageEmitter","fireError","asError","fireClose","firePartialMessage","readable","_partialMessageTimeout","timeout","nextMessageLength","messageToken","partialMessageTimer","on","onData","contentLength","parseInt","isNaN","msg","setPartialMessageTimer","clearPartialMessageTimer","json","parse","waitingTime","process","eventEmitter","socket","ContentLength","AbstractMessageWriter","count","writable","errorCount","join","sending","doWriteMessage","send","handleError","ParseError","InvalidRequest","InvalidParams","serverErrorStart","serverErrorEnd","ServerNotInitialized","UnknownErrorCode","RequestCancelled","MessageReadError","AbstractMessageType","_method","_numberOfParams","_","path_1","os_1","crypto_1","net_1","generateRandomPipeName","randomSuffix","randomBytes","platform","tmpdir","createClientPipeTransport","pipeName","connectResolve","connected","_reject","server","createServer","close","removeListener","onConnected","createServerPipeTransport","createConnection","createClientSocketTransport","port","createServerSocketTransport"],"mappings":"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","file":"8.bundle.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { AbstractViewContribution } from '@theia/core/lib/browser/shell/view-contribution';\nimport { Widget } from '@theia/core/lib/browser';\nimport { OUTPUT_WIDGET_KIND, OutputWidget } from './output-widget';\nimport { Command, CommandRegistry } from '@theia/core/lib/common';\n\nexport namespace OutputCommands {\n    const OUTPUT_CATEGORY = 'Output';\n    export const CLEAR_OUTPUT_TOOLBAR: Command = {\n        id: 'output:clear',\n        category: OUTPUT_CATEGORY,\n        label: 'Clear Output',\n        iconClass: 'clear-all'\n    };\n}\n\n@injectable()\nexport class OutputContribution extends AbstractViewContribution<OutputWidget> {\n\n    constructor() {\n        super({\n            widgetId: OUTPUT_WIDGET_KIND,\n            widgetName: 'Output',\n            defaultWidgetOptions: {\n                area: 'bottom'\n            },\n            toggleCommandId: 'output:toggle',\n            toggleKeybinding: 'ctrlcmd+shift+u'\n        });\n    }\n\n    registerCommands(commands: CommandRegistry): void {\n        super.registerCommands(commands);\n        commands.registerCommand(OutputCommands.CLEAR_OUTPUT_TOOLBAR, {\n            isEnabled: widget => this.withWidget(widget, () => true),\n            isVisible: widget => this.withWidget(widget, () => true),\n            execute: widget => this.withWidget(widget, outputWidget => this.clear(outputWidget))\n        });\n    }\n\n    protected async clear(widget: OutputWidget): Promise<void> {\n        widget.clear();\n    }\n\n    protected withWidget<T>(widget: Widget | undefined = this.tryGetWidget(), cb: (problems: OutputWidget) => T): T | false {\n        if (widget instanceof OutputWidget && widget.id === OUTPUT_WIDGET_KIND) {\n            return cb(widget);\n        }\n        return false;\n    }\n\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, postConstruct } from 'inversify';\nimport { Message } from '@theia/core/lib/browser';\nimport { OutputChannelManager, OutputChannel } from '../common/output-channel';\nimport { ReactWidget } from '@theia/core/lib/browser/widgets/react-widget';\nimport * as React from 'react';\n\nimport '../../src/browser/style/output.css';\n\nexport const OUTPUT_WIDGET_KIND = 'outputView';\n\n@injectable()\nexport class OutputWidget extends ReactWidget {\n\n    @inject(OutputChannelManager)\n    protected readonly outputChannelManager: OutputChannelManager;\n\n    constructor() {\n        super();\n        this.id = OUTPUT_WIDGET_KIND;\n        this.title.label = 'Output';\n        this.title.caption = 'Output';\n        this.title.iconClass = 'fa output-tab-icon';\n        this.title.closable = true;\n        this.addClass('theia-output');\n        this.node.tabIndex = 0;\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.outputChannelManager.getChannels().forEach(this.registerListener.bind(this));\n        this.toDispose.push(this.outputChannelManager.onChannelAdded(channel => {\n            this.registerListener(channel);\n            this.update();\n        }));\n        this.toDispose.push(this.outputChannelManager.onSelectedChannelChange(event => {\n            this.update();\n        }));\n        this.update();\n    }\n\n    protected onActivateRequest(msg: Message): void {\n        super.onActivateRequest(msg);\n        const channelSelector = document.getElementById(OutputWidget.IDs.CHANNEL_LIST);\n        if (channelSelector) {\n            channelSelector.focus();\n        } else {\n            this.node.focus();\n        }\n    }\n\n    protected registerListener(outputChannel: OutputChannel): void {\n        this.toDispose.push(outputChannel.onContentChange(c => {\n            if (outputChannel === this.outputChannelManager.selectedChannel) {\n                this.update();\n            }\n        }));\n    }\n\n    protected render(): React.ReactNode {\n        return <React.Fragment>\n            {this.renderChannelContents()}\n        </React.Fragment>;\n    }\n\n    public clear(): void {\n        if (this.outputChannelManager.selectedChannel) {\n            this.outputChannelManager.selectedChannel.clear();\n        }\n    }\n\n    protected renderChannelContents(): React.ReactNode {\n        return <div id={OutputWidget.IDs.CONTENTS}>{this.renderLines()}</div>;\n    }\n\n    protected renderLines(): React.ReactNode[] {\n        let id = 0;\n        const result = [];\n\n        const style: React.CSSProperties = {\n            whiteSpace: 'pre',\n            fontFamily: 'monospace',\n        };\n\n        if (this.outputChannelManager.selectedChannel) {\n            for (const text of this.outputChannelManager.selectedChannel.getLines()) {\n                const lines = text.split(/[\\n\\r]+/);\n                for (const line of lines) {\n                    result.push(<div style={style} key={id++}>{line}</div>);\n                }\n            }\n        }\n        if (result.length === 0) {\n            result.push(<div style={style} key={id++}>{'<no output yet>'}</div>);\n        }\n        return result;\n    }\n\n    protected onUpdateRequest(msg: Message): void {\n        super.onUpdateRequest(msg);\n        setTimeout(() => {\n            const div = document.getElementById(OutputWidget.IDs.CONTENTS) as HTMLDivElement;\n            if (div && div.children.length > 0) {\n                div.children[div.children.length - 1].scrollIntoView(false);\n            }\n        });\n    }\n}\n\nexport namespace OutputWidget {\n    export namespace IDs {\n        export const CONTENTS = 'outputContents';\n        export const CHANNEL_LIST = 'outputChannelList';\n    }\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Emitter, Event } from '@theia/core';\nimport { injectable, inject, postConstruct } from 'inversify';\nimport { OutputPreferences } from './output-preferences';\nimport { Disposable, DisposableCollection } from 'vscode-ws-jsonrpc';\n\n@injectable()\nexport class OutputChannelManager implements Disposable {\n    protected readonly channels = new Map<string, OutputChannel>();\n    protected selectedChannelValue: OutputChannel | undefined;\n\n    protected readonly channelDeleteEmitter = new Emitter<{ channelName: string }>();\n    protected readonly channelAddedEmitter = new Emitter<OutputChannel>();\n    protected readonly selectedChannelEmitter: Emitter<void> = new Emitter<void>();\n    protected readonly listOrSelectionEmitter: Emitter<void> = new Emitter<void>();\n    readonly onChannelDelete = this.channelDeleteEmitter.event;\n    readonly onChannelAdded = this.channelAddedEmitter.event;\n    readonly onSelectedChannelChange = this.selectedChannelEmitter.event;\n    readonly onListOrSelectionChange = this.listOrSelectionEmitter.event;\n\n    protected toDispose = new DisposableCollection();\n\n    @inject(OutputPreferences)\n    protected readonly preferences: OutputPreferences;\n\n    @postConstruct()\n    protected init(): void {\n        this.getChannels().forEach(this.registerListener.bind(this));\n        this.toDispose.push(this.onChannelAdded(channel => {\n            this.listOrSelectionEmitter.fire(undefined);\n            this.registerListener(channel);\n        }));\n        this.toDispose.push(this.onChannelDelete(event => {\n            this.listOrSelectionEmitter.fire(undefined);\n            if (this.selectedChannel && this.selectedChannel.name === event.channelName) {\n                this.selectedChannel = this.getVisibleChannels()[0];\n            }\n        }));\n    }\n\n    protected registerListener(outputChannel: OutputChannel): void {\n        if (!this.selectedChannel) {\n            this.selectedChannel = outputChannel;\n        }\n        this.toDispose.push(outputChannel.onVisibilityChange(event => {\n            if (event.visible) {\n                this.selectedChannel = outputChannel;\n            } else if (outputChannel === this.selectedChannel) {\n                this.selectedChannel = this.getVisibleChannels()[0];\n            }\n        }));\n    }\n\n    getChannel(name: string): OutputChannel {\n        const existing = this.channels.get(name);\n        if (existing) {\n            return existing;\n        }\n        const channel = new OutputChannel(name, this.preferences);\n        this.channels.set(name, channel);\n        this.channelAddedEmitter.fire(channel);\n        return channel;\n    }\n\n    deleteChannel(name: string): void {\n        this.channels.delete(name);\n        this.channelDeleteEmitter.fire({ channelName: name });\n    }\n\n    getChannels(): OutputChannel[] {\n        return Array.from(this.channels.values());\n    }\n\n    getVisibleChannels(): OutputChannel[] {\n        return this.getChannels().filter(channel => channel.isVisible);\n    }\n\n    public dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    get selectedChannel(): OutputChannel | undefined {\n        return this.selectedChannelValue;\n    }\n\n    set selectedChannel(channel: OutputChannel | undefined) {\n        this.selectedChannelValue = channel;\n        this.selectedChannelEmitter.fire(undefined);\n        this.listOrSelectionEmitter.fire(undefined);\n    }\n}\n\nexport class OutputChannel {\n\n    private readonly visibilityChangeEmitter = new Emitter<{ visible: boolean }>();\n    private readonly contentChangeEmitter = new Emitter<OutputChannel>();\n    private lines: string[] = [];\n    private currentLine: string | undefined;\n    private visible: boolean = true;\n\n    readonly onVisibilityChange: Event<{ visible: boolean }> = this.visibilityChangeEmitter.event;\n    readonly onContentChange: Event<OutputChannel> = this.contentChangeEmitter.event;\n\n    constructor(readonly name: string, readonly preferences: OutputPreferences) { }\n\n    append(value: string): void {\n        if (this.currentLine === undefined) {\n            this.currentLine = value;\n        } else {\n            this.currentLine += value;\n        }\n        this.contentChangeEmitter.fire(this);\n    }\n\n    appendLine(line: string): void {\n        if (this.currentLine !== undefined) {\n            this.lines.push(this.currentLine + line);\n            this.currentLine = undefined;\n        } else {\n            this.lines.push(line);\n        }\n        const maxChannelHistory = this.preferences['output.maxChannelHistory'];\n        if (this.lines.length > maxChannelHistory) {\n            this.lines.splice(0, this.lines.length - maxChannelHistory);\n        }\n        this.contentChangeEmitter.fire(this);\n    }\n\n    clear(): void {\n        this.lines.length = 0;\n        this.currentLine = undefined;\n        this.contentChangeEmitter.fire(this);\n    }\n\n    setVisibility(visible: boolean): void {\n        this.visible = visible;\n        this.visibilityChangeEmitter.fire({ visible });\n    }\n\n    getLines(): string[] {\n        if (this.currentLine !== undefined) {\n            return [...this.lines, this.currentLine];\n        } else {\n            return this.lines;\n        }\n    }\n\n    get isVisible(): boolean {\n        return this.visible;\n    }\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { interfaces } from 'inversify';\nimport {\n    createPreferenceProxy,\n    PreferenceProxy,\n    PreferenceService,\n    PreferenceContribution,\n    PreferenceSchema\n} from '@theia/core/lib/browser/preferences';\n\nexport const OutputConfigSchema: PreferenceSchema = {\n    'type': 'object',\n    'properties': {\n        'output.maxChannelHistory': {\n            'type': 'number',\n            'description': 'The maximum number of entries in an output channel.',\n            'default': 1000\n        }\n    }\n};\n\nexport interface OutputConfiguration {\n    'output.maxChannelHistory': number\n}\n\nexport const OutputPreferences = Symbol('OutputPreferences');\nexport type OutputPreferences = PreferenceProxy<OutputConfiguration>;\n\nexport function createOutputPreferences(preferences: PreferenceService): OutputPreferences {\n    return createPreferenceProxy(preferences, OutputConfigSchema);\n}\n\nexport function bindOutputPreferences(bind: interfaces.Bind): void {\n    bind(OutputPreferences).toDynamicValue(ctx => {\n        const preferences = ctx.container.get<PreferenceService>(PreferenceService);\n        return createOutputPreferences(preferences);\n    });\n\n    bind(PreferenceContribution).toConstantValue({ schema: OutputConfigSchema });\n}\n","\nvar content = require(\"!!../../../../../css-loader/index.js!./output.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../css-loader/index.js!./output.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../css-loader/index.js!./output.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/********************************************************************************\\n * Copyright (C) 2018 TypeFox and others.\\n *\\n * This program and the accompanying materials are made available under the\\n * terms of the Eclipse Public License v. 2.0 which is available at\\n * http://www.eclipse.org/legal/epl-2.0.\\n *\\n * This Source Code may also be made available under the following Secondary\\n * Licenses when the conditions for such availability set forth in the Eclipse\\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\\n * with the GNU Classpath Exception which is available at\\n * https://www.gnu.org/software/classpath/license.html.\\n *\\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\\n ********************************************************************************/\\n\\n #outputView {\\n\\tfont-size: var(--theia-ui-font-size1);\\n}\\n\\n#outputView #outputContents {\\n    overflow: auto;\\n    height: inherit;\\n    padding: 6px;\\n    box-sizing: border-box;\\n}\\n\\n.theia-side-panel #outputView #outputContents {\\n    margin-left: 14px;\\n}\\n\\n#outputView #outputChannelList {\\n    line-height: var(--theia-content-line-height);\\n    font-size: var(--theia-ui-font-size1);\\n    \\n    -webkit-appearance: none;\\n    -moz-appearance: none;\\n    background-position: calc(100% - 6px) 8px, calc(100% - 2px) 8px, 100% 0;\\n    background-size: 4px 5px;\\n    background-repeat: no-repeat;\\n    padding-left: 3px;\\n    padding-right: 15px;\\n}\\n\\n#outputView #outputClear {\\n    background-image: var(--theia-icon-clear);\\n    background-position: center;\\n    background-repeat: no-repeat;\\n    display: inline-block;\\n    width: 21px;\\n    opacity: var(--theia-mod-disabled-opacity);;\\n}\\n\\n#outputView #outputClear.enabled {\\n    opacity: 0.7;\\n    cursor: pointer;\\n}\\n\\n#outputView #outputClear.enabled:hover {\\n    opacity: 1;\\n}\\n\\n.output-tab-icon::before {\\n    content: \\\"\\\\F024\\\"\\n}\\n\", \"\"]);\n\n// exports\n","/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nimport { MessageConnection, Logger } from 'vscode-jsonrpc';\nimport { createWebSocketConnection, IWebSocket } from './socket';\nimport { ConsoleLogger } from './logger';\n\nexport function listen(options: {\n    webSocket: WebSocket;\n    logger?: Logger;\n    onConnection: (connection: MessageConnection) => void;\n}) {\n    const { webSocket, onConnection } = options;\n    const logger = options.logger || new ConsoleLogger();\n    webSocket.onopen = () => {\n        const socket = toSocket(webSocket);\n        const connection = createWebSocketConnection(socket, logger);\n        onConnection(connection);\n    };\n}\n\nexport function toSocket(webSocket: WebSocket): IWebSocket {\n    return {\n        send: content => webSocket.send(content),\n        onMessage: cb => webSocket.onmessage = event => cb(event.data),\n        onError: cb => webSocket.onerror = event => {\n            if ('message' in event) {\n                cb((event as any).message)\n            }\n        },\n        onClose: cb => webSocket.onclose = event => cb(event.code, event.reason),\n        dispose: () => webSocket.close()\n    }\n}","/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nimport { Disposable } from 'vscode-jsonrpc/lib/events';\n\nexport {\n    Disposable\n}\n\nexport class DisposableCollection implements Disposable {\n    protected readonly disposables: Disposable[] = [];\n\n    dispose(): void {\n        while (this.disposables.length !== 0) {\n            this.disposables.pop()!.dispose();\n        }\n    }\n\n    push(disposable: Disposable): Disposable {\n        const disposables = this.disposables;\n        disposables.push(disposable);\n        return {\n            dispose(): void {\n                const index = disposables.indexOf(disposable);\n                if (index !== -1) {\n                    disposables.splice(index, 1);\n                }\n            }\n        }\n    }\n\n}","/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nexport * from 'vscode-jsonrpc';\nexport * from 'vscode-jsonrpc/lib/messages';\nexport * from './disposable';\nexport * from './socket';\nexport * from './logger';\nexport * from './connection';","/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nimport { Logger } from \"vscode-jsonrpc\";\n\nexport class ConsoleLogger implements Logger {\n    public error(message: string): void {\n        console.error(message);\n    }\n\n    public warn(message: string): void {\n        console.warn(message);\n    }\n\n    public info(message: string): void {\n        console.info(message);\n    }\n\n    public log(message: string): void {\n        console.log(message);\n    }\n\n    public debug(message: string): void {\n        console.debug(message);\n    }\n}\n","/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nimport { MessageConnection, createMessageConnection, Logger } from \"vscode-jsonrpc\";\nimport { IWebSocket } from \"./socket\";\nimport { WebSocketMessageReader } from \"./reader\";\nimport { WebSocketMessageWriter } from \"./writer\";\n\nexport function createWebSocketConnection(socket: IWebSocket, logger: Logger): MessageConnection {\n    const messageReader = new WebSocketMessageReader(socket);\n    const messageWriter = new WebSocketMessageWriter(socket);\n    const connection = createMessageConnection(messageReader, messageWriter, logger);\n    connection.onClose(() => connection.dispose());\n    return connection;\n}\n","/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nexport * from './socket';\nexport * from './reader';\nexport * from './writer';\nexport * from './connection';\n","/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\n\nimport { DataCallback, AbstractMessageReader } from \"vscode-jsonrpc/lib/messageReader\";\nimport { IWebSocket } from \"./socket\";\n\nexport class WebSocketMessageReader extends AbstractMessageReader {\n\n    protected state: 'initial' | 'listening' | 'closed' = 'initial';\n    protected callback: DataCallback | undefined;\n    protected readonly events: { message?: any, error?: any }[] = [];\n\n    constructor(protected readonly socket: IWebSocket) {\n        super();\n        this.socket.onMessage(message =>\n            this.readMessage(message)\n        );\n        this.socket.onError(error =>\n            this.fireError(error)\n        );\n        this.socket.onClose((code, reason) => {\n            if (code !== 1000) {\n                const error: Error = {\n                    name: '' + code,\n                    message: `Error during socket reconnect: code = ${code}, reason = ${reason}`\n                };\n                this.fireError(error);\n            }\n            this.fireClose();\n        });\n    }\n\n    listen(callback: DataCallback): void {\n        if (this.state === 'initial') {\n            this.state = 'listening';\n            this.callback = callback;\n            while (this.events.length !== 0) {\n                const event = this.events.pop()!;\n                if (event.message) {\n                    this.readMessage(event.message);\n                } else if (event.error) {\n                    this.fireError(event.error);\n                } else {\n                    this.fireClose();\n                }\n            }\n        }\n    }\n\n    protected readMessage(message: any): void {\n        if (this.state === 'initial') {\n            this.events.splice(0, 0, { message });\n        } else if (this.state === 'listening') {\n            const data = JSON.parse(message);\n            this.callback!(data);\n        }\n    }\n\n    protected fireError(error: any): void {\n        if (this.state === 'initial') {\n            this.events.splice(0, 0, { error });\n        } else if (this.state === 'listening') {\n            super.fireError(error);\n        }\n    }\n\n    protected fireClose(): void {\n        if (this.state === 'initial') {\n            this.events.splice(0, 0, {});\n        } else if (this.state === 'listening') {\n            super.fireClose();\n        }\n        this.state = 'closed';\n    }\n\n}\n","/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\n\nimport { Message } from \"vscode-jsonrpc/lib/messages\";\nimport { AbstractMessageWriter } from \"vscode-jsonrpc/lib/messageWriter\";\nimport { IWebSocket } from \"./socket\";\n\nexport class WebSocketMessageWriter extends AbstractMessageWriter {\n\n    protected errorCount = 0;\n\n    constructor(protected readonly socket: IWebSocket) {\n        super();\n    }\n\n    write(msg: Message): void {\n        try {\n            const content = JSON.stringify(msg);\n            this.socket.send(content);\n        } catch (e) {\n            this.errorCount++;\n            this.fireError(e, msg, this.errorCount);\n        }\n    }\n\n}\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar events_1 = require(\"./events\");\r\nvar Is = require(\"./is\");\r\nvar CancellationToken;\r\n(function (CancellationToken) {\r\n    CancellationToken.None = Object.freeze({\r\n        isCancellationRequested: false,\r\n        onCancellationRequested: events_1.Event.None\r\n    });\r\n    CancellationToken.Cancelled = Object.freeze({\r\n        isCancellationRequested: true,\r\n        onCancellationRequested: events_1.Event.None\r\n    });\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && (candidate === CancellationToken.None\r\n            || candidate === CancellationToken.Cancelled\r\n            || (Is.boolean(candidate.isCancellationRequested) && !!candidate.onCancellationRequested));\r\n    }\r\n    CancellationToken.is = is;\r\n})(CancellationToken = exports.CancellationToken || (exports.CancellationToken = {}));\r\nvar shortcutEvent = Object.freeze(function (callback, context) {\r\n    var handle = setTimeout(callback.bind(context), 0);\r\n    return { dispose: function () { clearTimeout(handle); } };\r\n});\r\nvar MutableToken = /** @class */ (function () {\r\n    function MutableToken() {\r\n        this._isCancelled = false;\r\n    }\r\n    MutableToken.prototype.cancel = function () {\r\n        if (!this._isCancelled) {\r\n            this._isCancelled = true;\r\n            if (this._emitter) {\r\n                this._emitter.fire(undefined);\r\n                this._emitter = undefined;\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(MutableToken.prototype, \"isCancellationRequested\", {\r\n        get: function () {\r\n            return this._isCancelled;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MutableToken.prototype, \"onCancellationRequested\", {\r\n        get: function () {\r\n            if (this._isCancelled) {\r\n                return shortcutEvent;\r\n            }\r\n            if (!this._emitter) {\r\n                this._emitter = new events_1.Emitter();\r\n            }\r\n            return this._emitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return MutableToken;\r\n}());\r\nvar CancellationTokenSource = /** @class */ (function () {\r\n    function CancellationTokenSource() {\r\n    }\r\n    Object.defineProperty(CancellationTokenSource.prototype, \"token\", {\r\n        get: function () {\r\n            if (!this._token) {\r\n                // be lazy and create the token only when\r\n                // actually needed\r\n                this._token = new MutableToken();\r\n            }\r\n            return this._token;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CancellationTokenSource.prototype.cancel = function () {\r\n        if (!this._token) {\r\n            // save an object by returning the default\r\n            // cancelled token when cancellation happens\r\n            // before someone asks for the token\r\n            this._token = CancellationToken.Cancelled;\r\n        }\r\n        else {\r\n            this._token.cancel();\r\n        }\r\n    };\r\n    CancellationTokenSource.prototype.dispose = function () {\r\n        this.cancel();\r\n    };\r\n    return CancellationTokenSource;\r\n}());\r\nexports.CancellationTokenSource = CancellationTokenSource;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Disposable;\r\n(function (Disposable) {\r\n    function create(func) {\r\n        return {\r\n            dispose: func\r\n        };\r\n    }\r\n    Disposable.create = create;\r\n})(Disposable = exports.Disposable || (exports.Disposable = {}));\r\nvar Event;\r\n(function (Event) {\r\n    var _disposable = { dispose: function () { } };\r\n    Event.None = function () { return _disposable; };\r\n})(Event = exports.Event || (exports.Event = {}));\r\nvar CallbackList = /** @class */ (function () {\r\n    function CallbackList() {\r\n    }\r\n    CallbackList.prototype.add = function (callback, context, bucket) {\r\n        var _this = this;\r\n        if (context === void 0) { context = null; }\r\n        if (!this._callbacks) {\r\n            this._callbacks = [];\r\n            this._contexts = [];\r\n        }\r\n        this._callbacks.push(callback);\r\n        this._contexts.push(context);\r\n        if (Array.isArray(bucket)) {\r\n            bucket.push({ dispose: function () { return _this.remove(callback, context); } });\r\n        }\r\n    };\r\n    CallbackList.prototype.remove = function (callback, context) {\r\n        if (context === void 0) { context = null; }\r\n        if (!this._callbacks) {\r\n            return;\r\n        }\r\n        var foundCallbackWithDifferentContext = false;\r\n        for (var i = 0, len = this._callbacks.length; i < len; i++) {\r\n            if (this._callbacks[i] === callback) {\r\n                if (this._contexts[i] === context) {\r\n                    // callback & context match => remove it\r\n                    this._callbacks.splice(i, 1);\r\n                    this._contexts.splice(i, 1);\r\n                    return;\r\n                }\r\n                else {\r\n                    foundCallbackWithDifferentContext = true;\r\n                }\r\n            }\r\n        }\r\n        if (foundCallbackWithDifferentContext) {\r\n            throw new Error('When adding a listener with a context, you should remove it with the same context');\r\n        }\r\n    };\r\n    CallbackList.prototype.invoke = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (!this._callbacks) {\r\n            return [];\r\n        }\r\n        var ret = [], callbacks = this._callbacks.slice(0), contexts = this._contexts.slice(0);\r\n        for (var i = 0, len = callbacks.length; i < len; i++) {\r\n            try {\r\n                ret.push(callbacks[i].apply(contexts[i], args));\r\n            }\r\n            catch (e) {\r\n                console.error(e);\r\n            }\r\n        }\r\n        return ret;\r\n    };\r\n    CallbackList.prototype.isEmpty = function () {\r\n        return !this._callbacks || this._callbacks.length === 0;\r\n    };\r\n    CallbackList.prototype.dispose = function () {\r\n        this._callbacks = undefined;\r\n        this._contexts = undefined;\r\n    };\r\n    return CallbackList;\r\n}());\r\nvar Emitter = /** @class */ (function () {\r\n    function Emitter(_options) {\r\n        this._options = _options;\r\n    }\r\n    Object.defineProperty(Emitter.prototype, \"event\", {\r\n        /**\r\n         * For the public to allow to subscribe\r\n         * to events from this Emitter\r\n         */\r\n        get: function () {\r\n            var _this = this;\r\n            if (!this._event) {\r\n                this._event = function (listener, thisArgs, disposables) {\r\n                    if (!_this._callbacks) {\r\n                        _this._callbacks = new CallbackList();\r\n                    }\r\n                    if (_this._options && _this._options.onFirstListenerAdd && _this._callbacks.isEmpty()) {\r\n                        _this._options.onFirstListenerAdd(_this);\r\n                    }\r\n                    _this._callbacks.add(listener, thisArgs);\r\n                    var result;\r\n                    result = {\r\n                        dispose: function () {\r\n                            _this._callbacks.remove(listener, thisArgs);\r\n                            result.dispose = Emitter._noop;\r\n                            if (_this._options && _this._options.onLastListenerRemove && _this._callbacks.isEmpty()) {\r\n                                _this._options.onLastListenerRemove(_this);\r\n                            }\r\n                        }\r\n                    };\r\n                    if (Array.isArray(disposables)) {\r\n                        disposables.push(result);\r\n                    }\r\n                    return result;\r\n                };\r\n            }\r\n            return this._event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * To be kept private to fire an event to\r\n     * subscribers\r\n     */\r\n    Emitter.prototype.fire = function (event) {\r\n        if (this._callbacks) {\r\n            this._callbacks.invoke.call(this._callbacks, event);\r\n        }\r\n    };\r\n    Emitter.prototype.dispose = function () {\r\n        if (this._callbacks) {\r\n            this._callbacks.dispose();\r\n            this._callbacks = undefined;\r\n        }\r\n    };\r\n    Emitter._noop = function () { };\r\n    return Emitter;\r\n}());\r\nexports.Emitter = Emitter;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar toString = Object.prototype.toString;\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return toString.call(value) === '[object String]';\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return toString.call(value) === '[object Number]';\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return toString.call(value) === '[object Error]';\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return toString.call(value) === '[object Function]';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(function (elem) { return string(elem); });\r\n}\r\nexports.stringArray = stringArray;\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Touch;\r\n(function (Touch) {\r\n    Touch.None = 0;\r\n    Touch.First = 1;\r\n    Touch.Last = 2;\r\n})(Touch = exports.Touch || (exports.Touch = {}));\r\nvar LinkedMap = /** @class */ (function () {\r\n    function LinkedMap() {\r\n        this._map = new Map();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    LinkedMap.prototype.clear = function () {\r\n        this._map.clear();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    };\r\n    LinkedMap.prototype.isEmpty = function () {\r\n        return !this._head && !this._tail;\r\n    };\r\n    Object.defineProperty(LinkedMap.prototype, \"size\", {\r\n        get: function () {\r\n            return this._size;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LinkedMap.prototype.has = function (key) {\r\n        return this._map.has(key);\r\n    };\r\n    LinkedMap.prototype.get = function (key) {\r\n        var item = this._map.get(key);\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        return item.value;\r\n    };\r\n    LinkedMap.prototype.set = function (key, value, touch) {\r\n        if (touch === void 0) { touch = Touch.None; }\r\n        var item = this._map.get(key);\r\n        if (item) {\r\n            item.value = value;\r\n            if (touch !== Touch.None) {\r\n                this.touch(item, touch);\r\n            }\r\n        }\r\n        else {\r\n            item = { key: key, value: value, next: undefined, previous: undefined };\r\n            switch (touch) {\r\n                case Touch.None:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                case Touch.First:\r\n                    this.addItemFirst(item);\r\n                    break;\r\n                case Touch.Last:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                default:\r\n                    this.addItemLast(item);\r\n                    break;\r\n            }\r\n            this._map.set(key, item);\r\n            this._size++;\r\n        }\r\n    };\r\n    LinkedMap.prototype.delete = function (key) {\r\n        var item = this._map.get(key);\r\n        if (!item) {\r\n            return false;\r\n        }\r\n        this._map.delete(key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return true;\r\n    };\r\n    LinkedMap.prototype.shift = function () {\r\n        if (!this._head && !this._tail) {\r\n            return undefined;\r\n        }\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        var item = this._head;\r\n        this._map.delete(item.key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return item.value;\r\n    };\r\n    LinkedMap.prototype.forEach = function (callbackfn, thisArg) {\r\n        var current = this._head;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.next;\r\n        }\r\n    };\r\n    LinkedMap.prototype.forEachReverse = function (callbackfn, thisArg) {\r\n        var current = this._tail;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.previous;\r\n        }\r\n    };\r\n    LinkedMap.prototype.values = function () {\r\n        var result = [];\r\n        var current = this._head;\r\n        while (current) {\r\n            result.push(current.value);\r\n            current = current.next;\r\n        }\r\n        return result;\r\n    };\r\n    LinkedMap.prototype.keys = function () {\r\n        var result = [];\r\n        var current = this._head;\r\n        while (current) {\r\n            result.push(current.key);\r\n            current = current.next;\r\n        }\r\n        return result;\r\n    };\r\n    /* JSON RPC run on es5 which has no Symbol.iterator\r\n    public keys(): IterableIterator<K> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<K> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<K> {\r\n                if (current) {\r\n                    let result = { value: current.key, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n\r\n    public values(): IterableIterator<V> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<V> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<V> {\r\n                if (current) {\r\n                    let result = { value: current.value, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n    */\r\n    LinkedMap.prototype.addItemFirst = function (item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._tail = item;\r\n        }\r\n        else if (!this._head) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n        }\r\n        this._head = item;\r\n    };\r\n    LinkedMap.prototype.addItemLast = function (item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._head = item;\r\n        }\r\n        else if (!this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n        }\r\n        this._tail = item;\r\n    };\r\n    LinkedMap.prototype.removeItem = function (item) {\r\n        if (item === this._head && item === this._tail) {\r\n            this._head = undefined;\r\n            this._tail = undefined;\r\n        }\r\n        else if (item === this._head) {\r\n            this._head = item.next;\r\n        }\r\n        else if (item === this._tail) {\r\n            this._tail = item.previous;\r\n        }\r\n        else {\r\n            var next = item.next;\r\n            var previous = item.previous;\r\n            if (!next || !previous) {\r\n                throw new Error('Invalid list');\r\n            }\r\n            next.previous = previous;\r\n            previous.next = next;\r\n        }\r\n    };\r\n    LinkedMap.prototype.touch = function (item, touch) {\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        if ((touch !== Touch.First && touch !== Touch.Last)) {\r\n            return;\r\n        }\r\n        if (touch === Touch.First) {\r\n            if (item === this._head) {\r\n                return;\r\n            }\r\n            var next = item.next;\r\n            var previous = item.previous;\r\n            // Unlink the item\r\n            if (item === this._tail) {\r\n                // previous must be defined since item was not head but is tail\r\n                // So there are more than on item in the map\r\n                previous.next = undefined;\r\n                this._tail = previous;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            // Insert the node at head\r\n            item.previous = undefined;\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n            this._head = item;\r\n        }\r\n        else if (touch === Touch.Last) {\r\n            if (item === this._tail) {\r\n                return;\r\n            }\r\n            var next = item.next;\r\n            var previous = item.previous;\r\n            // Unlink the item.\r\n            if (item === this._head) {\r\n                // next must be defined since item was not tail but is head\r\n                // So there are more than on item in the map\r\n                next.previous = undefined;\r\n                this._head = next;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            item.next = undefined;\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n            this._tail = item;\r\n        }\r\n    };\r\n    return LinkedMap;\r\n}());\r\nexports.LinkedMap = LinkedMap;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n/// <reference path=\"./thenable.ts\" />\r\n'use strict';\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Is = require(\"./is\");\r\nvar messages_1 = require(\"./messages\");\r\nexports.RequestType = messages_1.RequestType;\r\nexports.RequestType0 = messages_1.RequestType0;\r\nexports.RequestType1 = messages_1.RequestType1;\r\nexports.RequestType2 = messages_1.RequestType2;\r\nexports.RequestType3 = messages_1.RequestType3;\r\nexports.RequestType4 = messages_1.RequestType4;\r\nexports.RequestType5 = messages_1.RequestType5;\r\nexports.RequestType6 = messages_1.RequestType6;\r\nexports.RequestType7 = messages_1.RequestType7;\r\nexports.RequestType8 = messages_1.RequestType8;\r\nexports.RequestType9 = messages_1.RequestType9;\r\nexports.ResponseError = messages_1.ResponseError;\r\nexports.ErrorCodes = messages_1.ErrorCodes;\r\nexports.NotificationType = messages_1.NotificationType;\r\nexports.NotificationType0 = messages_1.NotificationType0;\r\nexports.NotificationType1 = messages_1.NotificationType1;\r\nexports.NotificationType2 = messages_1.NotificationType2;\r\nexports.NotificationType3 = messages_1.NotificationType3;\r\nexports.NotificationType4 = messages_1.NotificationType4;\r\nexports.NotificationType5 = messages_1.NotificationType5;\r\nexports.NotificationType6 = messages_1.NotificationType6;\r\nexports.NotificationType7 = messages_1.NotificationType7;\r\nexports.NotificationType8 = messages_1.NotificationType8;\r\nexports.NotificationType9 = messages_1.NotificationType9;\r\nvar messageReader_1 = require(\"./messageReader\");\r\nexports.MessageReader = messageReader_1.MessageReader;\r\nexports.StreamMessageReader = messageReader_1.StreamMessageReader;\r\nexports.IPCMessageReader = messageReader_1.IPCMessageReader;\r\nexports.SocketMessageReader = messageReader_1.SocketMessageReader;\r\nvar messageWriter_1 = require(\"./messageWriter\");\r\nexports.MessageWriter = messageWriter_1.MessageWriter;\r\nexports.StreamMessageWriter = messageWriter_1.StreamMessageWriter;\r\nexports.IPCMessageWriter = messageWriter_1.IPCMessageWriter;\r\nexports.SocketMessageWriter = messageWriter_1.SocketMessageWriter;\r\nvar events_1 = require(\"./events\");\r\nexports.Disposable = events_1.Disposable;\r\nexports.Event = events_1.Event;\r\nexports.Emitter = events_1.Emitter;\r\nvar cancellation_1 = require(\"./cancellation\");\r\nexports.CancellationTokenSource = cancellation_1.CancellationTokenSource;\r\nexports.CancellationToken = cancellation_1.CancellationToken;\r\nvar linkedMap_1 = require(\"./linkedMap\");\r\n__export(require(\"./pipeSupport\"));\r\n__export(require(\"./socketSupport\"));\r\nvar CancelNotification;\r\n(function (CancelNotification) {\r\n    CancelNotification.type = new messages_1.NotificationType('$/cancelRequest');\r\n})(CancelNotification || (CancelNotification = {}));\r\nexports.NullLogger = Object.freeze({\r\n    error: function () { },\r\n    warn: function () { },\r\n    info: function () { },\r\n    log: function () { }\r\n});\r\nvar Trace;\r\n(function (Trace) {\r\n    Trace[Trace[\"Off\"] = 0] = \"Off\";\r\n    Trace[Trace[\"Messages\"] = 1] = \"Messages\";\r\n    Trace[Trace[\"Verbose\"] = 2] = \"Verbose\";\r\n})(Trace = exports.Trace || (exports.Trace = {}));\r\n(function (Trace) {\r\n    function fromString(value) {\r\n        value = value.toLowerCase();\r\n        switch (value) {\r\n            case 'off':\r\n                return Trace.Off;\r\n            case 'messages':\r\n                return Trace.Messages;\r\n            case 'verbose':\r\n                return Trace.Verbose;\r\n            default:\r\n                return Trace.Off;\r\n        }\r\n    }\r\n    Trace.fromString = fromString;\r\n    function toString(value) {\r\n        switch (value) {\r\n            case Trace.Off:\r\n                return 'off';\r\n            case Trace.Messages:\r\n                return 'messages';\r\n            case Trace.Verbose:\r\n                return 'verbose';\r\n            default:\r\n                return 'off';\r\n        }\r\n    }\r\n    Trace.toString = toString;\r\n})(Trace = exports.Trace || (exports.Trace = {}));\r\nvar SetTraceNotification;\r\n(function (SetTraceNotification) {\r\n    SetTraceNotification.type = new messages_1.NotificationType('$/setTraceNotification');\r\n})(SetTraceNotification = exports.SetTraceNotification || (exports.SetTraceNotification = {}));\r\nvar LogTraceNotification;\r\n(function (LogTraceNotification) {\r\n    LogTraceNotification.type = new messages_1.NotificationType('$/logTraceNotification');\r\n})(LogTraceNotification = exports.LogTraceNotification || (exports.LogTraceNotification = {}));\r\nvar ConnectionErrors;\r\n(function (ConnectionErrors) {\r\n    /**\r\n     * The connection is closed.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"Closed\"] = 1] = \"Closed\";\r\n    /**\r\n     * The connection got disposed.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"Disposed\"] = 2] = \"Disposed\";\r\n    /**\r\n     * The connection is already in listening mode.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"AlreadyListening\"] = 3] = \"AlreadyListening\";\r\n})(ConnectionErrors = exports.ConnectionErrors || (exports.ConnectionErrors = {}));\r\nvar ConnectionError = /** @class */ (function (_super) {\r\n    __extends(ConnectionError, _super);\r\n    function ConnectionError(code, message) {\r\n        var _this = _super.call(this, message) || this;\r\n        _this.code = code;\r\n        Object.setPrototypeOf(_this, ConnectionError.prototype);\r\n        return _this;\r\n    }\r\n    return ConnectionError;\r\n}(Error));\r\nexports.ConnectionError = ConnectionError;\r\nvar ConnectionStrategy;\r\n(function (ConnectionStrategy) {\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && Is.func(candidate.cancelUndispatched);\r\n    }\r\n    ConnectionStrategy.is = is;\r\n})(ConnectionStrategy = exports.ConnectionStrategy || (exports.ConnectionStrategy = {}));\r\nvar ConnectionState;\r\n(function (ConnectionState) {\r\n    ConnectionState[ConnectionState[\"New\"] = 1] = \"New\";\r\n    ConnectionState[ConnectionState[\"Listening\"] = 2] = \"Listening\";\r\n    ConnectionState[ConnectionState[\"Closed\"] = 3] = \"Closed\";\r\n    ConnectionState[ConnectionState[\"Disposed\"] = 4] = \"Disposed\";\r\n})(ConnectionState || (ConnectionState = {}));\r\nfunction _createMessageConnection(messageReader, messageWriter, logger, strategy) {\r\n    var sequenceNumber = 0;\r\n    var notificationSquenceNumber = 0;\r\n    var unknownResponseSquenceNumber = 0;\r\n    var version = '2.0';\r\n    var starRequestHandler = undefined;\r\n    var requestHandlers = Object.create(null);\r\n    var starNotificationHandler = undefined;\r\n    var notificationHandlers = Object.create(null);\r\n    var timer;\r\n    var messageQueue = new linkedMap_1.LinkedMap();\r\n    var responsePromises = Object.create(null);\r\n    var requestTokens = Object.create(null);\r\n    var trace = Trace.Off;\r\n    var tracer;\r\n    var state = ConnectionState.New;\r\n    var errorEmitter = new events_1.Emitter();\r\n    var closeEmitter = new events_1.Emitter();\r\n    var unhandledNotificationEmitter = new events_1.Emitter();\r\n    var disposeEmitter = new events_1.Emitter();\r\n    function createRequestQueueKey(id) {\r\n        return 'req-' + id.toString();\r\n    }\r\n    function createResponseQueueKey(id) {\r\n        if (id === null) {\r\n            return 'res-unknown-' + (++unknownResponseSquenceNumber).toString();\r\n        }\r\n        else {\r\n            return 'res-' + id.toString();\r\n        }\r\n    }\r\n    function createNotificationQueueKey() {\r\n        return 'not-' + (++notificationSquenceNumber).toString();\r\n    }\r\n    function addMessageToQueue(queue, message) {\r\n        if (messages_1.isRequestMessage(message)) {\r\n            queue.set(createRequestQueueKey(message.id), message);\r\n        }\r\n        else if (messages_1.isResponseMessage(message)) {\r\n            queue.set(createResponseQueueKey(message.id), message);\r\n        }\r\n        else {\r\n            queue.set(createNotificationQueueKey(), message);\r\n        }\r\n    }\r\n    function cancelUndispatched(_message) {\r\n        return undefined;\r\n    }\r\n    function isListening() {\r\n        return state === ConnectionState.Listening;\r\n    }\r\n    function isClosed() {\r\n        return state === ConnectionState.Closed;\r\n    }\r\n    function isDisposed() {\r\n        return state === ConnectionState.Disposed;\r\n    }\r\n    function closeHandler() {\r\n        if (state === ConnectionState.New || state === ConnectionState.Listening) {\r\n            state = ConnectionState.Closed;\r\n            closeEmitter.fire(undefined);\r\n        }\r\n        // If the connection is disposed don't sent close events.\r\n    }\r\n    ;\r\n    function readErrorHandler(error) {\r\n        errorEmitter.fire([error, undefined, undefined]);\r\n    }\r\n    function writeErrorHandler(data) {\r\n        errorEmitter.fire(data);\r\n    }\r\n    messageReader.onClose(closeHandler);\r\n    messageReader.onError(readErrorHandler);\r\n    messageWriter.onClose(closeHandler);\r\n    messageWriter.onError(writeErrorHandler);\r\n    function triggerMessageQueue() {\r\n        if (timer || messageQueue.size === 0) {\r\n            return;\r\n        }\r\n        timer = setImmediate(function () {\r\n            timer = undefined;\r\n            processMessageQueue();\r\n        });\r\n    }\r\n    function processMessageQueue() {\r\n        if (messageQueue.size === 0) {\r\n            return;\r\n        }\r\n        var message = messageQueue.shift();\r\n        try {\r\n            if (messages_1.isRequestMessage(message)) {\r\n                handleRequest(message);\r\n            }\r\n            else if (messages_1.isNotificationMessage(message)) {\r\n                handleNotification(message);\r\n            }\r\n            else if (messages_1.isResponseMessage(message)) {\r\n                handleResponse(message);\r\n            }\r\n            else {\r\n                handleInvalidMessage(message);\r\n            }\r\n        }\r\n        finally {\r\n            triggerMessageQueue();\r\n        }\r\n    }\r\n    var callback = function (message) {\r\n        try {\r\n            // We have received a cancellation message. Check if the message is still in the queue\r\n            // and cancel it if allowed to do so.\r\n            if (messages_1.isNotificationMessage(message) && message.method === CancelNotification.type.method) {\r\n                var key = createRequestQueueKey(message.params.id);\r\n                var toCancel = messageQueue.get(key);\r\n                if (messages_1.isRequestMessage(toCancel)) {\r\n                    var response = strategy && strategy.cancelUndispatched ? strategy.cancelUndispatched(toCancel, cancelUndispatched) : cancelUndispatched(toCancel);\r\n                    if (response && (response.error !== void 0 || response.result !== void 0)) {\r\n                        messageQueue.delete(key);\r\n                        response.id = toCancel.id;\r\n                        traceSendingResponse(response, message.method, Date.now());\r\n                        messageWriter.write(response);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            addMessageToQueue(messageQueue, message);\r\n        }\r\n        finally {\r\n            triggerMessageQueue();\r\n        }\r\n    };\r\n    function handleRequest(requestMessage) {\r\n        if (isDisposed()) {\r\n            // we return here silently since we fired an event when the\r\n            // connection got disposed.\r\n            return;\r\n        }\r\n        function reply(resultOrError, method, startTime) {\r\n            var message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id\r\n            };\r\n            if (resultOrError instanceof messages_1.ResponseError) {\r\n                message.error = resultOrError.toJson();\r\n            }\r\n            else {\r\n                message.result = resultOrError === void 0 ? null : resultOrError;\r\n            }\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        function replyError(error, method, startTime) {\r\n            var message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id,\r\n                error: error.toJson()\r\n            };\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        function replySuccess(result, method, startTime) {\r\n            // The JSON RPC defines that a response must either have a result or an error\r\n            // So we can't treat undefined as a valid response result.\r\n            if (result === void 0) {\r\n                result = null;\r\n            }\r\n            var message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id,\r\n                result: result\r\n            };\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        traceReceivedRequest(requestMessage);\r\n        var element = requestHandlers[requestMessage.method];\r\n        var type;\r\n        var requestHandler;\r\n        if (element) {\r\n            type = element.type;\r\n            requestHandler = element.handler;\r\n        }\r\n        var startTime = Date.now();\r\n        if (requestHandler || starRequestHandler) {\r\n            var cancellationSource = new cancellation_1.CancellationTokenSource();\r\n            var tokenKey_1 = String(requestMessage.id);\r\n            requestTokens[tokenKey_1] = cancellationSource;\r\n            try {\r\n                var handlerResult = void 0;\r\n                if (requestMessage.params === void 0 || (type !== void 0 && type.numberOfParams === 0)) {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, cancellationSource.token);\r\n                }\r\n                else if (Is.array(requestMessage.params) && (type === void 0 || type.numberOfParams > 1)) {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler.apply(void 0, requestMessage.params.concat([cancellationSource.token])) : starRequestHandler.apply(void 0, [requestMessage.method].concat(requestMessage.params, [cancellationSource.token]));\r\n                }\r\n                else {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(requestMessage.params, cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, requestMessage.params, cancellationSource.token);\r\n                }\r\n                var promise = handlerResult;\r\n                if (!handlerResult) {\r\n                    delete requestTokens[tokenKey_1];\r\n                    replySuccess(handlerResult, requestMessage.method, startTime);\r\n                }\r\n                else if (promise.then) {\r\n                    promise.then(function (resultOrError) {\r\n                        delete requestTokens[tokenKey_1];\r\n                        reply(resultOrError, requestMessage.method, startTime);\r\n                    }, function (error) {\r\n                        delete requestTokens[tokenKey_1];\r\n                        if (error instanceof messages_1.ResponseError) {\r\n                            replyError(error, requestMessage.method, startTime);\r\n                        }\r\n                        else if (error && Is.string(error.message)) {\r\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, \"Request \" + requestMessage.method + \" failed with message: \" + error.message), requestMessage.method, startTime);\r\n                        }\r\n                        else {\r\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, \"Request \" + requestMessage.method + \" failed unexpectedly without providing any details.\"), requestMessage.method, startTime);\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    delete requestTokens[tokenKey_1];\r\n                    reply(handlerResult, requestMessage.method, startTime);\r\n                }\r\n            }\r\n            catch (error) {\r\n                delete requestTokens[tokenKey_1];\r\n                if (error instanceof messages_1.ResponseError) {\r\n                    reply(error, requestMessage.method, startTime);\r\n                }\r\n                else if (error && Is.string(error.message)) {\r\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, \"Request \" + requestMessage.method + \" failed with message: \" + error.message), requestMessage.method, startTime);\r\n                }\r\n                else {\r\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, \"Request \" + requestMessage.method + \" failed unexpectedly without providing any details.\"), requestMessage.method, startTime);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.MethodNotFound, \"Unhandled method \" + requestMessage.method), requestMessage.method, startTime);\r\n        }\r\n    }\r\n    function handleResponse(responseMessage) {\r\n        if (isDisposed()) {\r\n            // See handle request.\r\n            return;\r\n        }\r\n        if (responseMessage.id === null) {\r\n            if (responseMessage.error) {\r\n                logger.error(\"Received response message without id: Error is: \\n\" + JSON.stringify(responseMessage.error, undefined, 4));\r\n            }\r\n            else {\r\n                logger.error(\"Received response message without id. No further error information provided.\");\r\n            }\r\n        }\r\n        else {\r\n            var key = String(responseMessage.id);\r\n            var responsePromise = responsePromises[key];\r\n            traceReceivedResponse(responseMessage, responsePromise);\r\n            if (responsePromise) {\r\n                delete responsePromises[key];\r\n                try {\r\n                    if (responseMessage.error) {\r\n                        var error = responseMessage.error;\r\n                        responsePromise.reject(new messages_1.ResponseError(error.code, error.message, error.data));\r\n                    }\r\n                    else if (responseMessage.result !== void 0) {\r\n                        responsePromise.resolve(responseMessage.result);\r\n                    }\r\n                    else {\r\n                        throw new Error('Should never happen.');\r\n                    }\r\n                }\r\n                catch (error) {\r\n                    if (error.message) {\r\n                        logger.error(\"Response handler '\" + responsePromise.method + \"' failed with message: \" + error.message);\r\n                    }\r\n                    else {\r\n                        logger.error(\"Response handler '\" + responsePromise.method + \"' failed unexpectedly.\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function handleNotification(message) {\r\n        if (isDisposed()) {\r\n            // See handle request.\r\n            return;\r\n        }\r\n        var type = undefined;\r\n        var notificationHandler;\r\n        if (message.method === CancelNotification.type.method) {\r\n            notificationHandler = function (params) {\r\n                var id = params.id;\r\n                var source = requestTokens[String(id)];\r\n                if (source) {\r\n                    source.cancel();\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            var element = notificationHandlers[message.method];\r\n            if (element) {\r\n                notificationHandler = element.handler;\r\n                type = element.type;\r\n            }\r\n        }\r\n        if (notificationHandler || starNotificationHandler) {\r\n            try {\r\n                traceReceivedNotification(message);\r\n                if (message.params === void 0 || (type !== void 0 && type.numberOfParams === 0)) {\r\n                    notificationHandler ? notificationHandler() : starNotificationHandler(message.method);\r\n                }\r\n                else if (Is.array(message.params) && (type === void 0 || type.numberOfParams > 1)) {\r\n                    notificationHandler ? notificationHandler.apply(void 0, message.params) : starNotificationHandler.apply(void 0, [message.method].concat(message.params));\r\n                }\r\n                else {\r\n                    notificationHandler ? notificationHandler(message.params) : starNotificationHandler(message.method, message.params);\r\n                }\r\n            }\r\n            catch (error) {\r\n                if (error.message) {\r\n                    logger.error(\"Notification handler '\" + message.method + \"' failed with message: \" + error.message);\r\n                }\r\n                else {\r\n                    logger.error(\"Notification handler '\" + message.method + \"' failed unexpectedly.\");\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            unhandledNotificationEmitter.fire(message);\r\n        }\r\n    }\r\n    function handleInvalidMessage(message) {\r\n        if (!message) {\r\n            logger.error('Received empty message.');\r\n            return;\r\n        }\r\n        logger.error(\"Received message which is neither a response nor a notification message:\\n\" + JSON.stringify(message, null, 4));\r\n        // Test whether we find an id to reject the promise\r\n        var responseMessage = message;\r\n        if (Is.string(responseMessage.id) || Is.number(responseMessage.id)) {\r\n            var key = String(responseMessage.id);\r\n            var responseHandler = responsePromises[key];\r\n            if (responseHandler) {\r\n                responseHandler.reject(new Error('The received response has neither a result nor an error property.'));\r\n            }\r\n        }\r\n    }\r\n    function traceSendingRequest(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        var data = undefined;\r\n        if (trace === Trace.Verbose && message.params) {\r\n            data = \"Params: \" + JSON.stringify(message.params, null, 4) + \"\\n\\n\";\r\n        }\r\n        tracer.log(\"Sending request '\" + message.method + \" - (\" + message.id + \")'.\", data);\r\n    }\r\n    function traceSendNotification(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        var data = undefined;\r\n        if (trace === Trace.Verbose) {\r\n            if (message.params) {\r\n                data = \"Params: \" + JSON.stringify(message.params, null, 4) + \"\\n\\n\";\r\n            }\r\n            else {\r\n                data = 'No parameters provided.\\n\\n';\r\n            }\r\n        }\r\n        tracer.log(\"Sending notification '\" + message.method + \"'.\", data);\r\n    }\r\n    function traceSendingResponse(message, method, startTime) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        var data = undefined;\r\n        if (trace === Trace.Verbose) {\r\n            if (message.error && message.error.data) {\r\n                data = \"Error data: \" + JSON.stringify(message.error.data, null, 4) + \"\\n\\n\";\r\n            }\r\n            else {\r\n                if (message.result) {\r\n                    data = \"Result: \" + JSON.stringify(message.result, null, 4) + \"\\n\\n\";\r\n                }\r\n                else if (message.error === void 0) {\r\n                    data = 'No result returned.\\n\\n';\r\n                }\r\n            }\r\n        }\r\n        tracer.log(\"Sending response '\" + method + \" - (\" + message.id + \")'. Processing request took \" + (Date.now() - startTime) + \"ms\", data);\r\n    }\r\n    function traceReceivedRequest(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        var data = undefined;\r\n        if (trace === Trace.Verbose && message.params) {\r\n            data = \"Params: \" + JSON.stringify(message.params, null, 4) + \"\\n\\n\";\r\n        }\r\n        tracer.log(\"Received request '\" + message.method + \" - (\" + message.id + \")'.\", data);\r\n    }\r\n    function traceReceivedNotification(message) {\r\n        if (trace === Trace.Off || !tracer || message.method === LogTraceNotification.type.method) {\r\n            return;\r\n        }\r\n        var data = undefined;\r\n        if (trace === Trace.Verbose) {\r\n            if (message.params) {\r\n                data = \"Params: \" + JSON.stringify(message.params, null, 4) + \"\\n\\n\";\r\n            }\r\n            else {\r\n                data = 'No parameters provided.\\n\\n';\r\n            }\r\n        }\r\n        tracer.log(\"Received notification '\" + message.method + \"'.\", data);\r\n    }\r\n    function traceReceivedResponse(message, responsePromise) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        var data = undefined;\r\n        if (trace === Trace.Verbose) {\r\n            if (message.error && message.error.data) {\r\n                data = \"Error data: \" + JSON.stringify(message.error.data, null, 4) + \"\\n\\n\";\r\n            }\r\n            else {\r\n                if (message.result) {\r\n                    data = \"Result: \" + JSON.stringify(message.result, null, 4) + \"\\n\\n\";\r\n                }\r\n                else if (message.error === void 0) {\r\n                    data = 'No result returned.\\n\\n';\r\n                }\r\n            }\r\n        }\r\n        if (responsePromise) {\r\n            var error = message.error ? \" Request failed: \" + message.error.message + \" (\" + message.error.code + \").\" : '';\r\n            tracer.log(\"Received response '\" + responsePromise.method + \" - (\" + message.id + \")' in \" + (Date.now() - responsePromise.timerStart) + \"ms.\" + error, data);\r\n        }\r\n        else {\r\n            tracer.log(\"Received response \" + message.id + \" without active response promise.\", data);\r\n        }\r\n    }\r\n    function throwIfClosedOrDisposed() {\r\n        if (isClosed()) {\r\n            throw new ConnectionError(ConnectionErrors.Closed, 'Connection is closed.');\r\n        }\r\n        if (isDisposed()) {\r\n            throw new ConnectionError(ConnectionErrors.Disposed, 'Connection is disposed.');\r\n        }\r\n    }\r\n    function throwIfListening() {\r\n        if (isListening()) {\r\n            throw new ConnectionError(ConnectionErrors.AlreadyListening, 'Connection is already listening');\r\n        }\r\n    }\r\n    function throwIfNotListening() {\r\n        if (!isListening()) {\r\n            throw new Error('Call listen() first.');\r\n        }\r\n    }\r\n    function undefinedToNull(param) {\r\n        if (param === void 0) {\r\n            return null;\r\n        }\r\n        else {\r\n            return param;\r\n        }\r\n    }\r\n    function computeMessageParams(type, params) {\r\n        var result;\r\n        var numberOfParams = type.numberOfParams;\r\n        switch (numberOfParams) {\r\n            case 0:\r\n                result = null;\r\n                break;\r\n            case 1:\r\n                result = undefinedToNull(params[0]);\r\n                break;\r\n            default:\r\n                result = [];\r\n                for (var i = 0; i < params.length && i < numberOfParams; i++) {\r\n                    result.push(undefinedToNull(params[i]));\r\n                }\r\n                if (params.length < numberOfParams) {\r\n                    for (var i = params.length; i < numberOfParams; i++) {\r\n                        result.push(null);\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n    var connection = {\r\n        sendNotification: function (type) {\r\n            var params = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                params[_i - 1] = arguments[_i];\r\n            }\r\n            throwIfClosedOrDisposed();\r\n            var method;\r\n            var messageParams;\r\n            if (Is.string(type)) {\r\n                method = type;\r\n                switch (params.length) {\r\n                    case 0:\r\n                        messageParams = null;\r\n                        break;\r\n                    case 1:\r\n                        messageParams = params[0];\r\n                        break;\r\n                    default:\r\n                        messageParams = params;\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                method = type.method;\r\n                messageParams = computeMessageParams(type, params);\r\n            }\r\n            var notificationMessage = {\r\n                jsonrpc: version,\r\n                method: method,\r\n                params: messageParams\r\n            };\r\n            traceSendNotification(notificationMessage);\r\n            messageWriter.write(notificationMessage);\r\n        },\r\n        onNotification: function (type, handler) {\r\n            throwIfClosedOrDisposed();\r\n            if (Is.func(type)) {\r\n                starNotificationHandler = type;\r\n            }\r\n            else if (handler) {\r\n                if (Is.string(type)) {\r\n                    notificationHandlers[type] = { type: undefined, handler: handler };\r\n                }\r\n                else {\r\n                    notificationHandlers[type.method] = { type: type, handler: handler };\r\n                }\r\n            }\r\n        },\r\n        sendRequest: function (type) {\r\n            var params = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                params[_i - 1] = arguments[_i];\r\n            }\r\n            throwIfClosedOrDisposed();\r\n            throwIfNotListening();\r\n            var method;\r\n            var messageParams;\r\n            var token = undefined;\r\n            if (Is.string(type)) {\r\n                method = type;\r\n                switch (params.length) {\r\n                    case 0:\r\n                        messageParams = null;\r\n                        break;\r\n                    case 1:\r\n                        // The cancellation token is optional so it can also be undefined.\r\n                        if (cancellation_1.CancellationToken.is(params[0])) {\r\n                            messageParams = null;\r\n                            token = params[0];\r\n                        }\r\n                        else {\r\n                            messageParams = undefinedToNull(params[0]);\r\n                        }\r\n                        break;\r\n                    default:\r\n                        var last = params.length - 1;\r\n                        if (cancellation_1.CancellationToken.is(params[last])) {\r\n                            token = params[last];\r\n                            if (params.length === 2) {\r\n                                messageParams = undefinedToNull(params[0]);\r\n                            }\r\n                            else {\r\n                                messageParams = params.slice(0, last).map(function (value) { return undefinedToNull(value); });\r\n                            }\r\n                        }\r\n                        else {\r\n                            messageParams = params.map(function (value) { return undefinedToNull(value); });\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                method = type.method;\r\n                messageParams = computeMessageParams(type, params);\r\n                var numberOfParams = type.numberOfParams;\r\n                token = cancellation_1.CancellationToken.is(params[numberOfParams]) ? params[numberOfParams] : undefined;\r\n            }\r\n            var id = sequenceNumber++;\r\n            var result = new Promise(function (resolve, reject) {\r\n                var requestMessage = {\r\n                    jsonrpc: version,\r\n                    id: id,\r\n                    method: method,\r\n                    params: messageParams\r\n                };\r\n                var responsePromise = { method: method, timerStart: Date.now(), resolve: resolve, reject: reject };\r\n                traceSendingRequest(requestMessage);\r\n                try {\r\n                    messageWriter.write(requestMessage);\r\n                }\r\n                catch (e) {\r\n                    // Writing the message failed. So we need to reject the promise.\r\n                    responsePromise.reject(new messages_1.ResponseError(messages_1.ErrorCodes.MessageWriteError, e.message ? e.message : 'Unknown reason'));\r\n                    responsePromise = null;\r\n                }\r\n                if (responsePromise) {\r\n                    responsePromises[String(id)] = responsePromise;\r\n                }\r\n            });\r\n            if (token) {\r\n                token.onCancellationRequested(function () {\r\n                    connection.sendNotification(CancelNotification.type, { id: id });\r\n                });\r\n            }\r\n            return result;\r\n        },\r\n        onRequest: function (type, handler) {\r\n            throwIfClosedOrDisposed();\r\n            if (Is.func(type)) {\r\n                starRequestHandler = type;\r\n            }\r\n            else if (handler) {\r\n                if (Is.string(type)) {\r\n                    requestHandlers[type] = { type: undefined, handler: handler };\r\n                }\r\n                else {\r\n                    requestHandlers[type.method] = { type: type, handler: handler };\r\n                }\r\n            }\r\n        },\r\n        trace: function (_value, _tracer, sendNotification) {\r\n            if (sendNotification === void 0) { sendNotification = false; }\r\n            trace = _value;\r\n            if (trace === Trace.Off) {\r\n                tracer = undefined;\r\n            }\r\n            else {\r\n                tracer = _tracer;\r\n            }\r\n            if (sendNotification && !isClosed() && !isDisposed()) {\r\n                connection.sendNotification(SetTraceNotification.type, { value: Trace.toString(_value) });\r\n            }\r\n        },\r\n        onError: errorEmitter.event,\r\n        onClose: closeEmitter.event,\r\n        onUnhandledNotification: unhandledNotificationEmitter.event,\r\n        onDispose: disposeEmitter.event,\r\n        dispose: function () {\r\n            if (isDisposed()) {\r\n                return;\r\n            }\r\n            state = ConnectionState.Disposed;\r\n            disposeEmitter.fire(undefined);\r\n            var error = new Error('Connection got disposed.');\r\n            Object.keys(responsePromises).forEach(function (key) {\r\n                responsePromises[key].reject(error);\r\n            });\r\n            responsePromises = Object.create(null);\r\n            requestTokens = Object.create(null);\r\n            messageQueue = new linkedMap_1.LinkedMap();\r\n            // Test for backwards compatibility\r\n            if (Is.func(messageWriter.dispose)) {\r\n                messageWriter.dispose();\r\n            }\r\n            if (Is.func(messageReader.dispose)) {\r\n                messageReader.dispose();\r\n            }\r\n        },\r\n        listen: function () {\r\n            throwIfClosedOrDisposed();\r\n            throwIfListening();\r\n            state = ConnectionState.Listening;\r\n            messageReader.listen(callback);\r\n        },\r\n        inspect: function () {\r\n            console.log(\"inspect\");\r\n        }\r\n    };\r\n    connection.onNotification(LogTraceNotification.type, function (params) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        tracer.log(params.message, trace === Trace.Verbose ? params.verbose : undefined);\r\n    });\r\n    return connection;\r\n}\r\nfunction isMessageReader(value) {\r\n    return value.listen !== void 0 && value.read === void 0;\r\n}\r\nfunction isMessageWriter(value) {\r\n    return value.write !== void 0 && value.end === void 0;\r\n}\r\nfunction createMessageConnection(input, output, logger, strategy) {\r\n    if (!logger) {\r\n        logger = exports.NullLogger;\r\n    }\r\n    var reader = isMessageReader(input) ? input : new messageReader_1.StreamMessageReader(input);\r\n    var writer = isMessageWriter(output) ? output : new messageWriter_1.StreamMessageWriter(output);\r\n    return _createMessageConnection(reader, writer, logger, strategy);\r\n}\r\nexports.createMessageConnection = createMessageConnection;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar events_1 = require(\"./events\");\r\nvar Is = require(\"./is\");\r\nvar DefaultSize = 8192;\r\nvar CR = new Buffer('\\r', 'ascii')[0];\r\nvar LF = new Buffer('\\n', 'ascii')[0];\r\nvar CRLF = '\\r\\n';\r\nvar MessageBuffer = /** @class */ (function () {\r\n    function MessageBuffer(encoding) {\r\n        if (encoding === void 0) { encoding = 'utf8'; }\r\n        this.encoding = encoding;\r\n        this.index = 0;\r\n        this.buffer = new Buffer(DefaultSize);\r\n    }\r\n    MessageBuffer.prototype.append = function (chunk) {\r\n        var toAppend = chunk;\r\n        if (typeof (chunk) === 'string') {\r\n            var str = chunk;\r\n            var bufferLen = Buffer.byteLength(str, this.encoding);\r\n            toAppend = new Buffer(bufferLen);\r\n            toAppend.write(str, 0, bufferLen, this.encoding);\r\n        }\r\n        if (this.buffer.length - this.index >= toAppend.length) {\r\n            toAppend.copy(this.buffer, this.index, 0, toAppend.length);\r\n        }\r\n        else {\r\n            var newSize = (Math.ceil((this.index + toAppend.length) / DefaultSize) + 1) * DefaultSize;\r\n            if (this.index === 0) {\r\n                this.buffer = new Buffer(newSize);\r\n                toAppend.copy(this.buffer, 0, 0, toAppend.length);\r\n            }\r\n            else {\r\n                this.buffer = Buffer.concat([this.buffer.slice(0, this.index), toAppend], newSize);\r\n            }\r\n        }\r\n        this.index += toAppend.length;\r\n    };\r\n    MessageBuffer.prototype.tryReadHeaders = function () {\r\n        var result = undefined;\r\n        var current = 0;\r\n        while (current + 3 < this.index && (this.buffer[current] !== CR || this.buffer[current + 1] !== LF || this.buffer[current + 2] !== CR || this.buffer[current + 3] !== LF)) {\r\n            current++;\r\n        }\r\n        // No header / body separator found (e.g CRLFCRLF)\r\n        if (current + 3 >= this.index) {\r\n            return result;\r\n        }\r\n        result = Object.create(null);\r\n        var headers = this.buffer.toString('ascii', 0, current).split(CRLF);\r\n        headers.forEach(function (header) {\r\n            var index = header.indexOf(':');\r\n            if (index === -1) {\r\n                throw new Error('Message header must separate key and value using :');\r\n            }\r\n            var key = header.substr(0, index);\r\n            var value = header.substr(index + 1).trim();\r\n            result[key] = value;\r\n        });\r\n        var nextStart = current + 4;\r\n        this.buffer = this.buffer.slice(nextStart);\r\n        this.index = this.index - nextStart;\r\n        return result;\r\n    };\r\n    MessageBuffer.prototype.tryReadContent = function (length) {\r\n        if (this.index < length) {\r\n            return null;\r\n        }\r\n        var result = this.buffer.toString(this.encoding, 0, length);\r\n        var nextStart = length;\r\n        this.buffer.copy(this.buffer, 0, nextStart);\r\n        this.index = this.index - nextStart;\r\n        return result;\r\n    };\r\n    Object.defineProperty(MessageBuffer.prototype, \"numberOfBytes\", {\r\n        get: function () {\r\n            return this.index;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return MessageBuffer;\r\n}());\r\nvar MessageReader;\r\n(function (MessageReader) {\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && Is.func(candidate.listen) && Is.func(candidate.dispose) &&\r\n            Is.func(candidate.onError) && Is.func(candidate.onClose) && Is.func(candidate.onPartialMessage);\r\n    }\r\n    MessageReader.is = is;\r\n})(MessageReader = exports.MessageReader || (exports.MessageReader = {}));\r\nvar AbstractMessageReader = /** @class */ (function () {\r\n    function AbstractMessageReader() {\r\n        this.errorEmitter = new events_1.Emitter();\r\n        this.closeEmitter = new events_1.Emitter();\r\n        this.partialMessageEmitter = new events_1.Emitter();\r\n    }\r\n    AbstractMessageReader.prototype.dispose = function () {\r\n        this.errorEmitter.dispose();\r\n        this.closeEmitter.dispose();\r\n    };\r\n    Object.defineProperty(AbstractMessageReader.prototype, \"onError\", {\r\n        get: function () {\r\n            return this.errorEmitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AbstractMessageReader.prototype.fireError = function (error) {\r\n        this.errorEmitter.fire(this.asError(error));\r\n    };\r\n    Object.defineProperty(AbstractMessageReader.prototype, \"onClose\", {\r\n        get: function () {\r\n            return this.closeEmitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AbstractMessageReader.prototype.fireClose = function () {\r\n        this.closeEmitter.fire(undefined);\r\n    };\r\n    Object.defineProperty(AbstractMessageReader.prototype, \"onPartialMessage\", {\r\n        get: function () {\r\n            return this.partialMessageEmitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AbstractMessageReader.prototype.firePartialMessage = function (info) {\r\n        this.partialMessageEmitter.fire(info);\r\n    };\r\n    AbstractMessageReader.prototype.asError = function (error) {\r\n        if (error instanceof Error) {\r\n            return error;\r\n        }\r\n        else {\r\n            return new Error(\"Reader recevied error. Reason: \" + (Is.string(error.message) ? error.message : 'unknown'));\r\n        }\r\n    };\r\n    return AbstractMessageReader;\r\n}());\r\nexports.AbstractMessageReader = AbstractMessageReader;\r\nvar StreamMessageReader = /** @class */ (function (_super) {\r\n    __extends(StreamMessageReader, _super);\r\n    function StreamMessageReader(readable, encoding) {\r\n        if (encoding === void 0) { encoding = 'utf8'; }\r\n        var _this = _super.call(this) || this;\r\n        _this.readable = readable;\r\n        _this.buffer = new MessageBuffer(encoding);\r\n        _this._partialMessageTimeout = 10000;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(StreamMessageReader.prototype, \"partialMessageTimeout\", {\r\n        get: function () {\r\n            return this._partialMessageTimeout;\r\n        },\r\n        set: function (timeout) {\r\n            this._partialMessageTimeout = timeout;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    StreamMessageReader.prototype.listen = function (callback) {\r\n        var _this = this;\r\n        this.nextMessageLength = -1;\r\n        this.messageToken = 0;\r\n        this.partialMessageTimer = undefined;\r\n        this.callback = callback;\r\n        this.readable.on('data', function (data) {\r\n            _this.onData(data);\r\n        });\r\n        this.readable.on('error', function (error) { return _this.fireError(error); });\r\n        this.readable.on('close', function () { return _this.fireClose(); });\r\n    };\r\n    StreamMessageReader.prototype.onData = function (data) {\r\n        this.buffer.append(data);\r\n        while (true) {\r\n            if (this.nextMessageLength === -1) {\r\n                var headers = this.buffer.tryReadHeaders();\r\n                if (!headers) {\r\n                    return;\r\n                }\r\n                var contentLength = headers['Content-Length'];\r\n                if (!contentLength) {\r\n                    throw new Error('Header must provide a Content-Length property.');\r\n                }\r\n                var length = parseInt(contentLength);\r\n                if (isNaN(length)) {\r\n                    throw new Error('Content-Length value must be a number.');\r\n                }\r\n                this.nextMessageLength = length;\r\n                // Take the encoding form the header. For compatibility\r\n                // treat both utf-8 and utf8 as node utf8\r\n            }\r\n            var msg = this.buffer.tryReadContent(this.nextMessageLength);\r\n            if (msg === null) {\r\n                /** We haven't recevied the full message yet. */\r\n                this.setPartialMessageTimer();\r\n                return;\r\n            }\r\n            this.clearPartialMessageTimer();\r\n            this.nextMessageLength = -1;\r\n            this.messageToken++;\r\n            var json = JSON.parse(msg);\r\n            this.callback(json);\r\n        }\r\n    };\r\n    StreamMessageReader.prototype.clearPartialMessageTimer = function () {\r\n        if (this.partialMessageTimer) {\r\n            clearTimeout(this.partialMessageTimer);\r\n            this.partialMessageTimer = undefined;\r\n        }\r\n    };\r\n    StreamMessageReader.prototype.setPartialMessageTimer = function () {\r\n        var _this = this;\r\n        this.clearPartialMessageTimer();\r\n        if (this._partialMessageTimeout <= 0) {\r\n            return;\r\n        }\r\n        this.partialMessageTimer = setTimeout(function (token, timeout) {\r\n            _this.partialMessageTimer = undefined;\r\n            if (token === _this.messageToken) {\r\n                _this.firePartialMessage({ messageToken: token, waitingTime: timeout });\r\n                _this.setPartialMessageTimer();\r\n            }\r\n        }, this._partialMessageTimeout, this.messageToken, this._partialMessageTimeout);\r\n    };\r\n    return StreamMessageReader;\r\n}(AbstractMessageReader));\r\nexports.StreamMessageReader = StreamMessageReader;\r\nvar IPCMessageReader = /** @class */ (function (_super) {\r\n    __extends(IPCMessageReader, _super);\r\n    function IPCMessageReader(process) {\r\n        var _this = _super.call(this) || this;\r\n        _this.process = process;\r\n        var eventEmitter = _this.process;\r\n        eventEmitter.on('error', function (error) { return _this.fireError(error); });\r\n        eventEmitter.on('close', function () { return _this.fireClose(); });\r\n        return _this;\r\n    }\r\n    IPCMessageReader.prototype.listen = function (callback) {\r\n        this.process.on('message', callback);\r\n    };\r\n    return IPCMessageReader;\r\n}(AbstractMessageReader));\r\nexports.IPCMessageReader = IPCMessageReader;\r\nvar SocketMessageReader = /** @class */ (function (_super) {\r\n    __extends(SocketMessageReader, _super);\r\n    function SocketMessageReader(socket, encoding) {\r\n        if (encoding === void 0) { encoding = 'utf-8'; }\r\n        return _super.call(this, socket, encoding) || this;\r\n    }\r\n    return SocketMessageReader;\r\n}(StreamMessageReader));\r\nexports.SocketMessageReader = SocketMessageReader;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar events_1 = require(\"./events\");\r\nvar Is = require(\"./is\");\r\nvar ContentLength = 'Content-Length: ';\r\nvar CRLF = '\\r\\n';\r\nvar MessageWriter;\r\n(function (MessageWriter) {\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && Is.func(candidate.dispose) && Is.func(candidate.onClose) &&\r\n            Is.func(candidate.onError) && Is.func(candidate.write);\r\n    }\r\n    MessageWriter.is = is;\r\n})(MessageWriter = exports.MessageWriter || (exports.MessageWriter = {}));\r\nvar AbstractMessageWriter = /** @class */ (function () {\r\n    function AbstractMessageWriter() {\r\n        this.errorEmitter = new events_1.Emitter();\r\n        this.closeEmitter = new events_1.Emitter();\r\n    }\r\n    AbstractMessageWriter.prototype.dispose = function () {\r\n        this.errorEmitter.dispose();\r\n        this.closeEmitter.dispose();\r\n    };\r\n    Object.defineProperty(AbstractMessageWriter.prototype, \"onError\", {\r\n        get: function () {\r\n            return this.errorEmitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AbstractMessageWriter.prototype.fireError = function (error, message, count) {\r\n        this.errorEmitter.fire([this.asError(error), message, count]);\r\n    };\r\n    Object.defineProperty(AbstractMessageWriter.prototype, \"onClose\", {\r\n        get: function () {\r\n            return this.closeEmitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AbstractMessageWriter.prototype.fireClose = function () {\r\n        this.closeEmitter.fire(undefined);\r\n    };\r\n    AbstractMessageWriter.prototype.asError = function (error) {\r\n        if (error instanceof Error) {\r\n            return error;\r\n        }\r\n        else {\r\n            return new Error(\"Writer recevied error. Reason: \" + (Is.string(error.message) ? error.message : 'unknown'));\r\n        }\r\n    };\r\n    return AbstractMessageWriter;\r\n}());\r\nexports.AbstractMessageWriter = AbstractMessageWriter;\r\nvar StreamMessageWriter = /** @class */ (function (_super) {\r\n    __extends(StreamMessageWriter, _super);\r\n    function StreamMessageWriter(writable, encoding) {\r\n        if (encoding === void 0) { encoding = 'utf8'; }\r\n        var _this = _super.call(this) || this;\r\n        _this.writable = writable;\r\n        _this.encoding = encoding;\r\n        _this.errorCount = 0;\r\n        _this.writable.on('error', function (error) { return _this.fireError(error); });\r\n        _this.writable.on('close', function () { return _this.fireClose(); });\r\n        return _this;\r\n    }\r\n    StreamMessageWriter.prototype.write = function (msg) {\r\n        var json = JSON.stringify(msg);\r\n        var contentLength = Buffer.byteLength(json, this.encoding);\r\n        var headers = [\r\n            ContentLength, contentLength.toString(), CRLF,\r\n            CRLF\r\n        ];\r\n        try {\r\n            // Header must be written in ASCII encoding\r\n            this.writable.write(headers.join(''), 'ascii');\r\n            // Now write the content. This can be written in any encoding\r\n            this.writable.write(json, this.encoding);\r\n            this.errorCount = 0;\r\n        }\r\n        catch (error) {\r\n            this.errorCount++;\r\n            this.fireError(error, msg, this.errorCount);\r\n        }\r\n    };\r\n    return StreamMessageWriter;\r\n}(AbstractMessageWriter));\r\nexports.StreamMessageWriter = StreamMessageWriter;\r\nvar IPCMessageWriter = /** @class */ (function (_super) {\r\n    __extends(IPCMessageWriter, _super);\r\n    function IPCMessageWriter(process) {\r\n        var _this = _super.call(this) || this;\r\n        _this.process = process;\r\n        _this.errorCount = 0;\r\n        _this.queue = [];\r\n        _this.sending = false;\r\n        var eventEmitter = _this.process;\r\n        eventEmitter.on('error', function (error) { return _this.fireError(error); });\r\n        eventEmitter.on('close', function () { return _this.fireClose; });\r\n        return _this;\r\n    }\r\n    IPCMessageWriter.prototype.write = function (msg) {\r\n        if (!this.sending && this.queue.length === 0) {\r\n            // See https://github.com/nodejs/node/issues/7657\r\n            this.doWriteMessage(msg);\r\n        }\r\n        else {\r\n            this.queue.push(msg);\r\n        }\r\n    };\r\n    IPCMessageWriter.prototype.doWriteMessage = function (msg) {\r\n        var _this = this;\r\n        try {\r\n            if (this.process.send) {\r\n                this.sending = true;\r\n                this.process.send(msg, undefined, undefined, function (error) {\r\n                    _this.sending = false;\r\n                    if (error) {\r\n                        _this.errorCount++;\r\n                        _this.fireError(error, msg, _this.errorCount);\r\n                    }\r\n                    else {\r\n                        _this.errorCount = 0;\r\n                    }\r\n                    if (_this.queue.length > 0) {\r\n                        _this.doWriteMessage(_this.queue.shift());\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        catch (error) {\r\n            this.errorCount++;\r\n            this.fireError(error, msg, this.errorCount);\r\n        }\r\n    };\r\n    return IPCMessageWriter;\r\n}(AbstractMessageWriter));\r\nexports.IPCMessageWriter = IPCMessageWriter;\r\nvar SocketMessageWriter = /** @class */ (function (_super) {\r\n    __extends(SocketMessageWriter, _super);\r\n    function SocketMessageWriter(socket, encoding) {\r\n        if (encoding === void 0) { encoding = 'utf8'; }\r\n        var _this = _super.call(this) || this;\r\n        _this.socket = socket;\r\n        _this.queue = [];\r\n        _this.sending = false;\r\n        _this.encoding = encoding;\r\n        _this.errorCount = 0;\r\n        _this.socket.on('error', function (error) { return _this.fireError(error); });\r\n        _this.socket.on('close', function () { return _this.fireClose(); });\r\n        return _this;\r\n    }\r\n    SocketMessageWriter.prototype.write = function (msg) {\r\n        if (!this.sending && this.queue.length === 0) {\r\n            // See https://github.com/nodejs/node/issues/7657\r\n            this.doWriteMessage(msg);\r\n        }\r\n        else {\r\n            this.queue.push(msg);\r\n        }\r\n    };\r\n    SocketMessageWriter.prototype.doWriteMessage = function (msg) {\r\n        var _this = this;\r\n        var json = JSON.stringify(msg);\r\n        var contentLength = Buffer.byteLength(json, this.encoding);\r\n        var headers = [\r\n            ContentLength, contentLength.toString(), CRLF,\r\n            CRLF\r\n        ];\r\n        try {\r\n            // Header must be written in ASCII encoding\r\n            this.sending = true;\r\n            this.socket.write(headers.join(''), 'ascii', function (error) {\r\n                if (error) {\r\n                    _this.handleError(error, msg);\r\n                }\r\n                try {\r\n                    // Now write the content. This can be written in any encoding\r\n                    _this.socket.write(json, _this.encoding, function (error) {\r\n                        _this.sending = false;\r\n                        if (error) {\r\n                            _this.handleError(error, msg);\r\n                        }\r\n                        else {\r\n                            _this.errorCount = 0;\r\n                        }\r\n                        if (_this.queue.length > 0) {\r\n                            _this.doWriteMessage(_this.queue.shift());\r\n                        }\r\n                    });\r\n                }\r\n                catch (error) {\r\n                    _this.handleError(error, msg);\r\n                }\r\n            });\r\n        }\r\n        catch (error) {\r\n            this.handleError(error, msg);\r\n        }\r\n    };\r\n    SocketMessageWriter.prototype.handleError = function (error, msg) {\r\n        this.errorCount++;\r\n        this.fireError(error, msg, this.errorCount);\r\n    };\r\n    return SocketMessageWriter;\r\n}(AbstractMessageWriter));\r\nexports.SocketMessageWriter = SocketMessageWriter;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar is = require(\"./is\");\r\n/**\r\n * Predefined error codes.\r\n */\r\nvar ErrorCodes;\r\n(function (ErrorCodes) {\r\n    // Defined by JSON RPC\r\n    ErrorCodes.ParseError = -32700;\r\n    ErrorCodes.InvalidRequest = -32600;\r\n    ErrorCodes.MethodNotFound = -32601;\r\n    ErrorCodes.InvalidParams = -32602;\r\n    ErrorCodes.InternalError = -32603;\r\n    ErrorCodes.serverErrorStart = -32099;\r\n    ErrorCodes.serverErrorEnd = -32000;\r\n    ErrorCodes.ServerNotInitialized = -32002;\r\n    ErrorCodes.UnknownErrorCode = -32001;\r\n    // Defined by the protocol.\r\n    ErrorCodes.RequestCancelled = -32800;\r\n    // Defined by VSCode library.\r\n    ErrorCodes.MessageWriteError = 1;\r\n    ErrorCodes.MessageReadError = 2;\r\n})(ErrorCodes = exports.ErrorCodes || (exports.ErrorCodes = {}));\r\n/**\r\n * An error object return in a response in case a request\r\n * has failed.\r\n */\r\nvar ResponseError = /** @class */ (function (_super) {\r\n    __extends(ResponseError, _super);\r\n    function ResponseError(code, message, data) {\r\n        var _this = _super.call(this, message) || this;\r\n        _this.code = is.number(code) ? code : ErrorCodes.UnknownErrorCode;\r\n        _this.data = data;\r\n        Object.setPrototypeOf(_this, ResponseError.prototype);\r\n        return _this;\r\n    }\r\n    ResponseError.prototype.toJson = function () {\r\n        return {\r\n            code: this.code,\r\n            message: this.message,\r\n            data: this.data,\r\n        };\r\n    };\r\n    return ResponseError;\r\n}(Error));\r\nexports.ResponseError = ResponseError;\r\n/**\r\n * An abstract implementation of a MessageType.\r\n */\r\nvar AbstractMessageType = /** @class */ (function () {\r\n    function AbstractMessageType(_method, _numberOfParams) {\r\n        this._method = _method;\r\n        this._numberOfParams = _numberOfParams;\r\n    }\r\n    Object.defineProperty(AbstractMessageType.prototype, \"method\", {\r\n        get: function () {\r\n            return this._method;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AbstractMessageType.prototype, \"numberOfParams\", {\r\n        get: function () {\r\n            return this._numberOfParams;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return AbstractMessageType;\r\n}());\r\nexports.AbstractMessageType = AbstractMessageType;\r\n/**\r\n * Classes to type request response pairs\r\n */\r\nvar RequestType0 = /** @class */ (function (_super) {\r\n    __extends(RequestType0, _super);\r\n    function RequestType0(method) {\r\n        var _this = _super.call(this, method, 0) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType0;\r\n}(AbstractMessageType));\r\nexports.RequestType0 = RequestType0;\r\nvar RequestType = /** @class */ (function (_super) {\r\n    __extends(RequestType, _super);\r\n    function RequestType(method) {\r\n        var _this = _super.call(this, method, 1) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType;\r\n}(AbstractMessageType));\r\nexports.RequestType = RequestType;\r\nvar RequestType1 = /** @class */ (function (_super) {\r\n    __extends(RequestType1, _super);\r\n    function RequestType1(method) {\r\n        var _this = _super.call(this, method, 1) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType1;\r\n}(AbstractMessageType));\r\nexports.RequestType1 = RequestType1;\r\nvar RequestType2 = /** @class */ (function (_super) {\r\n    __extends(RequestType2, _super);\r\n    function RequestType2(method) {\r\n        var _this = _super.call(this, method, 2) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType2;\r\n}(AbstractMessageType));\r\nexports.RequestType2 = RequestType2;\r\nvar RequestType3 = /** @class */ (function (_super) {\r\n    __extends(RequestType3, _super);\r\n    function RequestType3(method) {\r\n        var _this = _super.call(this, method, 3) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType3;\r\n}(AbstractMessageType));\r\nexports.RequestType3 = RequestType3;\r\nvar RequestType4 = /** @class */ (function (_super) {\r\n    __extends(RequestType4, _super);\r\n    function RequestType4(method) {\r\n        var _this = _super.call(this, method, 4) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType4;\r\n}(AbstractMessageType));\r\nexports.RequestType4 = RequestType4;\r\nvar RequestType5 = /** @class */ (function (_super) {\r\n    __extends(RequestType5, _super);\r\n    function RequestType5(method) {\r\n        var _this = _super.call(this, method, 5) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType5;\r\n}(AbstractMessageType));\r\nexports.RequestType5 = RequestType5;\r\nvar RequestType6 = /** @class */ (function (_super) {\r\n    __extends(RequestType6, _super);\r\n    function RequestType6(method) {\r\n        var _this = _super.call(this, method, 6) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType6;\r\n}(AbstractMessageType));\r\nexports.RequestType6 = RequestType6;\r\nvar RequestType7 = /** @class */ (function (_super) {\r\n    __extends(RequestType7, _super);\r\n    function RequestType7(method) {\r\n        var _this = _super.call(this, method, 7) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType7;\r\n}(AbstractMessageType));\r\nexports.RequestType7 = RequestType7;\r\nvar RequestType8 = /** @class */ (function (_super) {\r\n    __extends(RequestType8, _super);\r\n    function RequestType8(method) {\r\n        var _this = _super.call(this, method, 8) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType8;\r\n}(AbstractMessageType));\r\nexports.RequestType8 = RequestType8;\r\nvar RequestType9 = /** @class */ (function (_super) {\r\n    __extends(RequestType9, _super);\r\n    function RequestType9(method) {\r\n        var _this = _super.call(this, method, 9) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return RequestType9;\r\n}(AbstractMessageType));\r\nexports.RequestType9 = RequestType9;\r\nvar NotificationType = /** @class */ (function (_super) {\r\n    __extends(NotificationType, _super);\r\n    function NotificationType(method) {\r\n        var _this = _super.call(this, method, 1) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType;\r\n}(AbstractMessageType));\r\nexports.NotificationType = NotificationType;\r\nvar NotificationType0 = /** @class */ (function (_super) {\r\n    __extends(NotificationType0, _super);\r\n    function NotificationType0(method) {\r\n        var _this = _super.call(this, method, 0) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType0;\r\n}(AbstractMessageType));\r\nexports.NotificationType0 = NotificationType0;\r\nvar NotificationType1 = /** @class */ (function (_super) {\r\n    __extends(NotificationType1, _super);\r\n    function NotificationType1(method) {\r\n        var _this = _super.call(this, method, 1) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType1;\r\n}(AbstractMessageType));\r\nexports.NotificationType1 = NotificationType1;\r\nvar NotificationType2 = /** @class */ (function (_super) {\r\n    __extends(NotificationType2, _super);\r\n    function NotificationType2(method) {\r\n        var _this = _super.call(this, method, 2) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType2;\r\n}(AbstractMessageType));\r\nexports.NotificationType2 = NotificationType2;\r\nvar NotificationType3 = /** @class */ (function (_super) {\r\n    __extends(NotificationType3, _super);\r\n    function NotificationType3(method) {\r\n        var _this = _super.call(this, method, 3) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType3;\r\n}(AbstractMessageType));\r\nexports.NotificationType3 = NotificationType3;\r\nvar NotificationType4 = /** @class */ (function (_super) {\r\n    __extends(NotificationType4, _super);\r\n    function NotificationType4(method) {\r\n        var _this = _super.call(this, method, 4) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType4;\r\n}(AbstractMessageType));\r\nexports.NotificationType4 = NotificationType4;\r\nvar NotificationType5 = /** @class */ (function (_super) {\r\n    __extends(NotificationType5, _super);\r\n    function NotificationType5(method) {\r\n        var _this = _super.call(this, method, 5) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType5;\r\n}(AbstractMessageType));\r\nexports.NotificationType5 = NotificationType5;\r\nvar NotificationType6 = /** @class */ (function (_super) {\r\n    __extends(NotificationType6, _super);\r\n    function NotificationType6(method) {\r\n        var _this = _super.call(this, method, 6) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType6;\r\n}(AbstractMessageType));\r\nexports.NotificationType6 = NotificationType6;\r\nvar NotificationType7 = /** @class */ (function (_super) {\r\n    __extends(NotificationType7, _super);\r\n    function NotificationType7(method) {\r\n        var _this = _super.call(this, method, 7) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType7;\r\n}(AbstractMessageType));\r\nexports.NotificationType7 = NotificationType7;\r\nvar NotificationType8 = /** @class */ (function (_super) {\r\n    __extends(NotificationType8, _super);\r\n    function NotificationType8(method) {\r\n        var _this = _super.call(this, method, 8) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType8;\r\n}(AbstractMessageType));\r\nexports.NotificationType8 = NotificationType8;\r\nvar NotificationType9 = /** @class */ (function (_super) {\r\n    __extends(NotificationType9, _super);\r\n    function NotificationType9(method) {\r\n        var _this = _super.call(this, method, 9) || this;\r\n        _this._ = undefined;\r\n        return _this;\r\n    }\r\n    return NotificationType9;\r\n}(AbstractMessageType));\r\nexports.NotificationType9 = NotificationType9;\r\n/**\r\n * Tests if the given message is a request message\r\n */\r\nfunction isRequestMessage(message) {\r\n    var candidate = message;\r\n    return candidate && is.string(candidate.method) && (is.string(candidate.id) || is.number(candidate.id));\r\n}\r\nexports.isRequestMessage = isRequestMessage;\r\n/**\r\n * Tests if the given message is a notification message\r\n */\r\nfunction isNotificationMessage(message) {\r\n    var candidate = message;\r\n    return candidate && is.string(candidate.method) && message.id === void 0;\r\n}\r\nexports.isNotificationMessage = isNotificationMessage;\r\n/**\r\n * Tests if the given message is a response message\r\n */\r\nfunction isResponseMessage(message) {\r\n    var candidate = message;\r\n    return candidate && (candidate.result !== void 0 || !!candidate.error) && (is.string(candidate.id) || is.number(candidate.id) || candidate.id === null);\r\n}\r\nexports.isResponseMessage = isResponseMessage;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar path_1 = require(\"path\");\r\nvar os_1 = require(\"os\");\r\nvar crypto_1 = require(\"crypto\");\r\nvar net_1 = require(\"net\");\r\nvar messageReader_1 = require(\"./messageReader\");\r\nvar messageWriter_1 = require(\"./messageWriter\");\r\nfunction generateRandomPipeName() {\r\n    var randomSuffix = crypto_1.randomBytes(21).toString('hex');\r\n    if (process.platform === 'win32') {\r\n        return \"\\\\\\\\.\\\\pipe\\\\vscode-jsonrpc-\" + randomSuffix + \"-sock\";\r\n    }\r\n    else {\r\n        // Mac/Unix: use socket file\r\n        return path_1.join(os_1.tmpdir(), \"vscode-\" + randomSuffix + \".sock\");\r\n    }\r\n}\r\nexports.generateRandomPipeName = generateRandomPipeName;\r\nfunction createClientPipeTransport(pipeName, encoding) {\r\n    if (encoding === void 0) { encoding = 'utf-8'; }\r\n    var connectResolve;\r\n    var connected = new Promise(function (resolve, _reject) {\r\n        connectResolve = resolve;\r\n    });\r\n    return new Promise(function (resolve, reject) {\r\n        var server = net_1.createServer(function (socket) {\r\n            server.close();\r\n            connectResolve([\r\n                new messageReader_1.SocketMessageReader(socket, encoding),\r\n                new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n            ]);\r\n        });\r\n        server.on('error', reject);\r\n        server.listen(pipeName, function () {\r\n            server.removeListener('error', reject);\r\n            resolve({\r\n                onConnected: function () { return connected; }\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.createClientPipeTransport = createClientPipeTransport;\r\nfunction createServerPipeTransport(pipeName, encoding) {\r\n    if (encoding === void 0) { encoding = 'utf-8'; }\r\n    var socket = net_1.createConnection(pipeName);\r\n    return [\r\n        new messageReader_1.SocketMessageReader(socket, encoding),\r\n        new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n    ];\r\n}\r\nexports.createServerPipeTransport = createServerPipeTransport;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar net_1 = require(\"net\");\r\nvar messageReader_1 = require(\"./messageReader\");\r\nvar messageWriter_1 = require(\"./messageWriter\");\r\nfunction createClientSocketTransport(port, encoding) {\r\n    if (encoding === void 0) { encoding = 'utf-8'; }\r\n    var connectResolve;\r\n    var connected = new Promise(function (resolve, _reject) {\r\n        connectResolve = resolve;\r\n    });\r\n    return new Promise(function (resolve, reject) {\r\n        var server = net_1.createServer(function (socket) {\r\n            server.close();\r\n            connectResolve([\r\n                new messageReader_1.SocketMessageReader(socket, encoding),\r\n                new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n            ]);\r\n        });\r\n        server.on('error', reject);\r\n        server.listen(port, '127.0.0.1', function () {\r\n            server.removeListener('error', reject);\r\n            resolve({\r\n                onConnected: function () { return connected; }\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.createClientSocketTransport = createClientSocketTransport;\r\nfunction createServerSocketTransport(port, encoding) {\r\n    if (encoding === void 0) { encoding = 'utf-8'; }\r\n    var socket = net_1.createConnection(port, '127.0.0.1');\r\n    return [\r\n        new messageReader_1.SocketMessageReader(socket, encoding),\r\n        new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n    ];\r\n}\r\nexports.createServerSocketTransport = createServerSocketTransport;\r\n"],"sourceRoot":""}